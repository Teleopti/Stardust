<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Teleopti.Ccc.Domain"
                   namespace="Teleopti.Ccc.Domain.Auditing"
                   default-access="field.camelcase-underscore"
				   schema="Auditing">

  <class name="PersonAccess">
    <!--IEntity-->
    <id name="Id" type="guid" access="nosetter.camelcase-underscore" unsaved-value="null">
      <generator class="guid.comb" />
    </id>

    <!--IEntity-->

    <property name="TimeStamp"
			 access="property"
			 not-null="true"
			type="UtcDateTime" />

    <property name="Action"
			 access="property"
					not-null="true"
					length="255"
					type="string" />

	  <property name="ActionResult"
			 access="property"
				not-null="true"
				length="128"
				type="string" />

	  <property name="Data"
			 access="property"
				not-null="true"
				length="8001"
				type="string" />

	  <property name="Correlation"
			 access="property"
				not-null="true"
				type="guid" />

		<property name="ActionPerformedById"
				  access="property"
				  not-null="true"
				  type="guid" />

	  <property name="ActionPerformedBy"
				access="property"
				not-null="false"
				length="300"
				type="string" />
	  <property name="ActionPerformedOnId"
				access="property"
				not-null="true"
				type="guid" />

	  <property name="ActionPerformedOn"
				access="property"
				not-null="false"
				length="300"
				type="string" />
  </class>
	<query name="PersonAccessAuditOnCriteria">
		<![CDATA[
Select s from PersonAccess s
			where s.TimeStamp between :StartDate and :EndDate and :PersonId = s.ActionPerformedById

]]>
	</query>
	<query name="PurgePersonAccess">
		<![CDATA[
DELETE from PersonAccess
			where TimeStamp < : DaysBack

]]>
	</query>
</hibernate-mapping>