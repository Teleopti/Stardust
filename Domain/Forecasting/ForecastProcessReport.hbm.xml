<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Teleopti.Ccc.Domain"
                   namespace="Teleopti.Ccc.Domain.Forecasting"
                   default-access="field.camelcase-underscore">
  <query name="ValidationReport">
    <![CDATA[
    select vvd.VolumeDayDate from ValidatedVolumeDay vvd
                                where vvd.Workload = :workload
                                and vvd.VolumeDayDate between :startDate and :endDate
    ]]>
    <query-param name="workload" type="Workload"/>
    <query-param name="startDate" type="datetime"/>
    <query-param name="endDate" type="datetime"/>
  </query>

  <query name="BudgetReport">
    <![CDATA[
    select wldb.CurrentDate from WorkloadDay wldb
                                inner join wldb.Parent sdb
                                where wldb.Workload = :workload
                                and wldb.TemplateReference.TemplateName = :longtermKey
                                and wldb.CurrentDate between :startDate and :endDate
                                and sdb.Scenario = :scenario
    ]]>
    <query-param name="scenario" type="Teleopti.Ccc.Domain.Common.Scenario"/>
    <query-param name="workload" type="Workload"/>
    <query-param name="startDate" type="datetime"/>
    <query-param name="endDate" type="datetime"/>
    <query-param name="longtermKey" type="string"/>
  </query>

  <query name="DetailReport">
    <![CDATA[
    select wldb.CurrentDate from WorkloadDay wldb
                                inner join wldb.Parent sdb 
                                where wldb.Workload = :workload
                                and (wldb.TemplateReference.TemplateName is null OR wldb.TemplateReference.TemplateName <> :longtermKey)
                                and wldb.CurrentDate between :startDate and :endDate
                                and sdb.Scenario = :scenario
    ]]>
    <query-param name="scenario" type="Teleopti.Ccc.Domain.Common.Scenario"/>
    <query-param name="workload" type="Workload"/>
    <query-param name="startDate" type="datetime"/>
    <query-param name="endDate" type="datetime"/>
    <query-param name="longtermKey" type="string"/>
  </query>

	<sql-query name="ExistingForecast">
		<![CDATA[
    select sk.Name as Name, sk.Id as Id, sdb.SkillDayDate as CurrentDate from Skill sk WITH (NOLOCK)
                                inner join SkillType st WITH (NOLOCK) on sk.SkillType=st.Id
																left join SkillDay sdb WITH (NOLOCK) on (sk.Id=sdb.Skill) and (sdb.SkillDayDate between :startDate and :endDate) and (sdb.Scenario = :scenario) 
																left join WorkloadDay wld WITH (NOLOCK) on (wld.Parent = sdb.Id) and (wld.TemplateName is null OR wld.TemplateName <> :longtermKey)
																left join WorkloadDayBase wldb WITH (NOLOCK) on wld.WorkloadDayBase = wldb.Id
                                where sk.IsDeleted = 0
                                and st.Name != 'SkillTypeOutbound'
																and sk.BusinessUnit = :businessUnit
																group by sk.Name, sk.Id, sdb.SkillDayDate

															
    ]]>
		<query-param name="scenario" type="Teleopti.Ccc.Domain.Common.Scenario"/>
		<query-param name="businessUnit" type="Teleopti.Ccc.Domain.Common.BusinessUnit"/>
		<query-param name="startDate" type="datetime"/>
		<query-param name="endDate" type="datetime"/>
		<query-param name="longtermKey" type="string"/>
	</sql-query>
</hibernate-mapping>