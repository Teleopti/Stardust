<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Teleopti.Ccc.Domain"
                   namespace="Teleopti.Ccc.Domain.Scheduling.Restriction"
                   default-access="field.camelcase-underscore">
  <class name="PreferenceRestrictionTemplate">
    <id name="Id"
            type="guid"
		  access="nosetter.camelcase-underscore"
            unsaved-value="null">
      <generator class="foreign">
        <param name ="property">Parent</param>
      </generator>
    </id>

    <component name="StartTimeLimitation" class="Teleopti.Interfaces.Domain.StartTimeLimitation, Teleopti.Ccc.Domain">
      <property name="StartTime" column="StartTimeMinimum" />
      <property name="EndTime" column="StartTimeMaximum" />
    </component>

    <component name="EndTimeLimitation" class="Teleopti.Interfaces.Domain.EndTimeLimitation, Teleopti.Ccc.Domain">
      <property name="StartTime" column="EndTimeMinimum" />
      <property name="EndTime" column="EndTimeMaximum" />
    </component>

    <component name="WorkTimeLimitation" class="Teleopti.Interfaces.Domain.WorkTimeLimitation, Teleopti.Ccc.Domain">
      <property name="StartTime" column="WorkTimeMinimum" />
      <property name="EndTime" column="WorkTimeMaximum" />
    </component>

    <property name="MustHave"
          type="boolean"
          not-null="true"/>
    <one-to-one name="Parent"
                class="Teleopti.Ccc.Domain.Scheduling.Restriction.ExtendedPreferenceTemplate"
                foreign-key="FK_PreferenceRestrictionTemplate_ExtendedPreferenceTemplate"
                constrained="true"/>

    <many-to-one class="Teleopti.Ccc.Domain.Scheduling.ShiftCategory"
                 name="ShiftCategory"
                 not-null="false" foreign-key="FK_PreferenceRestrictionTemplate_ShiftCategory"/>
    <many-to-one  class ="Teleopti.Ccc.Domain.Scheduling.DayOffTemplate"
              name="DayOffTemplate"
              foreign-key="FK_PreferenceRestictionTemplate_DayOff"
              not-null="false"/>
    <many-to-one class="Teleopti.Ccc.Domain.Scheduling.Absence"
                name="Absence"
                not-null="false" foreign-key="FK_PreferenceRestriction_Absence"/>

    <bag name="ActivityRestrictionCollection"
            cascade="all-delete-orphan">
      <key column ="Parent" />
      <one-to-many class="Teleopti.Ccc.Domain.Scheduling.Restriction.ActivityRestrictionTemplate" />
    </bag>

  </class>
</hibernate-mapping>
