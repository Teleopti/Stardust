<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Teleopti.Ccc.Domain"
                   namespace="Teleopti.Ccc.Domain.Scheduling"
                   default-access="field.camelcase-underscore">

	<class name="Absence">
		<!--IEntity-->
		<id name="Id"
				type="guid"
			 access="nosetter.camelcase-underscore"
				unsaved-value="null">
			<generator class="guid.comb" />
		</id>
		<version name="Version"
				 unsaved-value ="null"/>
		<many-to-one name="UpdatedBy"
					 class="Teleopti.Ccc.Domain.Common.Person"
					 not-null="true"
					 foreign-key="FK_Absence_Person_UpdatedBy" />
		<property name="UpdatedOn"
				  type="UtcDateTime"
				  not-null="true"/>
		<!--IEntity-->

		
		<component name="Description" class="Teleopti.Interfaces.Domain.Description, Teleopti.Interfaces">
			<property name="Name"
					  not-null="true"
					  type="string"
					  length="50"/>
			<property name="ShortName"
					  not-null="false"
					  type="string"
					  length="25"/>
		</component>
		<property name="DisplayColor"
          type="Teleopti.Ccc.Infrastructure.NHibernateConfiguration.ColorNumber, Teleopti.Ccc.Infrastructure"
				  not-null="true" />
		<property name="Tracker"
				  type="Teleopti.Ccc.Infrastructure.NHibernateConfiguration.TrackerByte, Teleopti.Ccc.Infrastructure"
				  not-null="false"/>

    <property name="Confidential"
          not-null="true"/>

    <property name="Priority"
				  type="byte"
				  not-null="true" />

    <property name="PayrollCode"
        not-null="false"
        type="string"
        length="20"/>
    
		<property name="InContractTime"
				  type="boolean"
				  not-null="true" />
    <property name="InWorkTime"
          type="boolean"
          not-null="true" />
    <property name="InPaidTime"
          type="boolean"
          not-null="true" />
		<property name="Requestable"
			  type="boolean"
			  not-null="true" />
		<many-to-one name="BusinessUnit"
					 class="Teleopti.Ccc.Domain.Common.BusinessUnit"
            access="nosetter.camelcase-underscore"
					 not-null="true" foreign-key="FK_Absence_BusinessUnit"/>
		<property name="IsDeleted"
			  type="boolean"
			  not-null="true"/>
    
		<filter name="businessUnitFilter"
			condition=":businessUnitParameter = BusinessUnit" />
		<filter name="deletedFlagFilter"
		  condition="IsDeleted = 0" />
	</class>

	<query name="FindAbsenceTrackerUsedByPersonAccount">
		<![CDATA[    
		select abs 
		from Absence abs
		where exists(from PersonAbsenceAccount pa where pa.Absence=abs)
    ]]>
	</query>

</hibernate-mapping>
