<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
                   assembly="Teleopti.Ccc.Domain"
                   namespace="Teleopti.Ccc.Domain.Staffing"
                   default-access="field.camelcase-underscore"
				   schema="Auditing">

  <class name="TenantAudit">
    <!--IEntity-->
    <id name="Id" type="guid" access="nosetter.camelcase-underscore" unsaved-value="null">
      <generator class="guid.comb" />
    </id>

    <!--IEntity-->

    <property name="TimeStamp"
			 access="property"
			 not-null="true"
			type="UtcDateTime" />

    <property name="Action"
			 access="property"
					not-null="true"
					length="255"
					type="string" />

	  <property name="ActionResult"
				access="property"
				not-null="true"
				length="255"
				type="string" />
	  
	  <property name="Data"
			 access="property"
				not-null="true"
				length="8001"
				type="string" />
	
	  <property name="Area"
				access="property"
				not-null="true"
				length="255"
				type="string" />

	  <property name="Correlation"
				access="property"
				not-null="true"
				type="guid" />
	  
    <many-to-one name="ActionPerformedBy"
      class="Teleopti.Ccc.Domain.Common.Person"
		access="property"
        not-null="true"/>

	  <many-to-one name="ActionPerformedOn"
				   class="Teleopti.Ccc.Domain.Common.Person"
				   access="property"
				   not-null="true"/>

	 
  </class>
<query name="TenantAuditOnCriteria">
	<![CDATA[
Select s from Tenant.Audit s
			where s.TimeStamp between :StartDate and :EndDate and :PersonId = s.ActionPerformedBy

]]>
</query>
</hibernate-mapping>