<!--DataContext: EditLayerViewModel-->
<UserControl x:Class="Teleopti.Ccc.SmartClientPortal.Shell.Win.WpfControls.Controls.Editor.Views.EditLayerSimpleRowView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:Commands="clr-namespace:Teleopti.Ccc.WinCode.Common.Commands"
    xmlns:DateTimeConverter="clr-namespace:Teleopti.Ccc.WinCode.Converters.DateTimeConverter"
    xmlns:UserTexts="clr-namespace:Teleopti.Ccc.UserTexts;assembly=Teleopti.Ccc.UserTexts"
    xmlns:GuiHelpers="clr-namespace:Teleopti.Ccc.WinCode.Common.GuiHelpers"
    xmlns:converters="clr-namespace:Teleopti.Ccc.SmartClientPortal.Shell.Win.WpfControls.Converters"
    xmlns:views="clr-namespace:Teleopti.Ccc.SmartClientPortal.Shell.Win.WpfControls.Controls.Editor.Views">


    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="..\..\..\Resources\Common.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <converters:ColorConverter x:Key="ColorConverter"/>
            <DateTimeConverter:DateTimeToLocalStringConverter x:Key="startDateTimeToLocalStringConverter"/>
            <DateTimeConverter:DateTimeToLocalStringConverter x:Key="endDateTimeToLocalStringConverter"/>
            <DateTimeConverter:DateTimeParseMode x:Key="TimeMode">Time</DateTimeConverter:DateTimeParseMode>
            <DateTimeConverter:DateTimeParseMode x:Key="DateMode">Date</DateTimeConverter:DateTimeParseMode>
            
			<DataTemplate x:Key="PayloadTemplate">
				<views:ActivityShortView DataContext="{Binding}"/>
			</DataTemplate>
			
			<Geometry x:Key="DownArrowGeometry">M 0 0 L 3.5 4 L 7 0 Z</Geometry>
			
		</ResourceDictionary>
    </UserControl.Resources>

	<Border BorderThickness="0" CornerRadius="0" Padding="3" Margin="1" Background="{Binding Path=Layer.DisplayColor, Converter={StaticResource ColorConverter}, TargetNullValue=White, FallbackValue=White}">
        <Grid Commands:CreateCommandBinding.CommandModel="{Binding Path=UpdateLayerCommand}">

            <Grid  Commands:CreateCommandBinding.Target="{Binding Path=Period}" >
                <Grid.Resources>
                    <Style TargetType="RepeatButton" BasedOn="{StaticResource BaseButtonStyle}" >
                      <Setter Property="Padding" Value="0"></Setter>
                    </Style>
                </Grid.Resources>
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Grid Grid.Column="0" Margin="3,0,3,0">
                    
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition MinWidth="75"/>
                        <ColumnDefinition MinWidth="45"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

					<RepeatButton   MaxHeight="22" Width="30" Command="{x:Static Commands:CommonRoutedCommands.MovePeriodOneIntervalEarlier}" Grid.Column="0" Content="&lt;&lt;" Padding="0" x:Name="MoveBackButton" />

					<RepeatButton   MaxHeight="22" Width="15" Command="{x:Static Commands:CommonRoutedCommands.MoveStartOneIntervalEarlier}"  Grid.Column="1" Content="&lt;" Padding="0" x:Name="DecreaseStartButton" />
                    
                    <TextBox MaxHeight="22" Keyboard.KeyDown="TextBox_KeyDown" Grid.Column="2" x:Name="FromDatTextBox">
						<TextBox.Text>
							<MultiBinding Converter="{StaticResource startDateTimeToLocalStringConverter}" ConverterParameter="{StaticResource DateMode}" Mode="TwoWay">
								<MultiBinding.Bindings>
									<Binding Path="Period.Start"/>
									<Binding RelativeSource="{RelativeSource Self}" Path="(GuiHelpers:VisualTreeTimeZoneInfo.TimeZoneInfo)"/>
								</MultiBinding.Bindings>
							</MultiBinding>
						</TextBox.Text>
						
					</TextBox>

                    <TextBox MaxHeight="22" Keyboard.KeyDown="TextBox_KeyDown" Grid.Column="3" >
                        <TextBox.Text>
                            <MultiBinding Converter="{StaticResource startDateTimeToLocalStringConverter}" ConverterParameter="{StaticResource TimeMode}" Mode="TwoWay">
                                <MultiBinding.Bindings>
                                    <Binding Path="Period.Start"/>
                                    <Binding RelativeSource="{RelativeSource Self}" Path="(GuiHelpers:VisualTreeTimeZoneInfo.TimeZoneInfo)"/>
                                </MultiBinding.Bindings>
                            </MultiBinding>
                        </TextBox.Text>
						<TextBox.Style>
							<Style TargetType="TextBox">
								<Style.Triggers>
									<DataTrigger Binding="{Binding ElementName=DecreaseStartButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=IncreaseStartButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=MoveForwardButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=MoveBackButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
								</Style.Triggers>
							</Style>
						</TextBox.Style>
					</TextBox>
					<RepeatButton  MaxHeight="22"  Width="15" Command="{x:Static Commands:CommonRoutedCommands.MoveStartOneIntervalLater}" Grid.Column="4" HorizontalAlignment="Left" Content="&gt;" Padding="0" x:Name="IncreaseStartButton"/>
                </Grid>

                <!--EndDateTime-->
                <Grid Grid.Column="2" Margin="3,0,3,0" >
				
					<Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition MinWidth="75"/>
                        <ColumnDefinition MinWidth="45"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
					<RepeatButton  MaxHeight="22" Width="15" Command="{x:Static Commands:CommonRoutedCommands.MoveEndOneIntervalEarlier}" HorizontalAlignment="Right" Grid.Column="1" Content="&lt;" Padding="0" x:Name="DecreaseEndButton" >
					</RepeatButton>
                    <TextBox MaxHeight="22" Keyboard.KeyDown="TextBox_KeyDown" Grid.Column="2" >
                        <TextBox.Text>
                            <MultiBinding Converter="{StaticResource endDateTimeToLocalStringConverter}" ConverterParameter="{StaticResource DateMode}" Mode="TwoWay">
                                <MultiBinding.Bindings>
                                    <Binding Path="Period.End"/>
                                    <Binding RelativeSource="{RelativeSource Self}" Path="(GuiHelpers:VisualTreeTimeZoneInfo.TimeZoneInfo)"/>
                                </MultiBinding.Bindings>
                            </MultiBinding>
                        </TextBox.Text>
					
					</TextBox>

                    <TextBox MaxHeight="22" Keyboard.KeyDown="TextBox_KeyDown" Grid.Column="3">
                        <TextBox.Text>
                            <MultiBinding Converter="{StaticResource endDateTimeToLocalStringConverter}" ConverterParameter="{StaticResource TimeMode}" Mode="TwoWay">
                                <MultiBinding.Bindings>
                                    <Binding Path="Period.End"/>
                                    <Binding RelativeSource="{RelativeSource Self}" Path="(GuiHelpers:VisualTreeTimeZoneInfo.TimeZoneInfo)"/>
                                </MultiBinding.Bindings>
                            </MultiBinding>
                        </TextBox.Text>
						<TextBox.Style>
							<Style TargetType="TextBox">
								<Style.Triggers>
									<DataTrigger Binding="{Binding ElementName=DecreaseEndButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=IncreaseEndButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=MoveForwardButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
									<DataTrigger Binding="{Binding ElementName=MoveBackButton, Path=IsMouseOver}" Value="True">
										<Setter Property="FontWeight" Value="Bold"></Setter>
									</DataTrigger>
								</Style.Triggers>
							</Style>
						</TextBox.Style>
					</TextBox>

					<RepeatButton  MaxHeight="22" Width="15" Command="{x:Static Commands:CommonRoutedCommands.MoveEndOneIntervalLater}" Grid.Column="4" Content="&gt;" Padding="0" x:Name="IncreaseEndButton" />
					<RepeatButton  MaxHeight="22" Width="30" Command="{x:Static Commands:CommonRoutedCommands.MovePeriodOneIntervalLater}" Grid.Column="5" Content="&gt;&gt;" Padding="0"  x:Name="MoveForwardButton"/>
                </Grid>

				<ComboBox  MaxHeight="22"
						   ItemsSource="{Binding Path=SelectablePayloads}"  
                          IsSynchronizedWithCurrentItem="True"  
                          Grid.Column="3" 
                          Style="{StaticResource BasicComboBox}"
                          ItemTemplate="{StaticResource PayloadTemplate}"/>

				<Path
				Margin="3,1,8,0"
					 Grid.Column="3"
                  Fill="{Binding Path=Foreground, ElementName=CmBox}"
                  Data="{DynamicResource DownArrowGeometry}"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Center" IsHitTestVisible="False">
				</Path>

				<Button Padding="15,0" Command="{Binding Path=UpdateLayerCommand.Command}"
				    MaxHeight="22"
                    Grid.Column="4"
				    Content="{x:Static UserTexts:Resources.Update}" IsDefault="True" Focusable="True">
                </Button>
                
            </Grid>
        </Grid>
    </Border>
</UserControl>
