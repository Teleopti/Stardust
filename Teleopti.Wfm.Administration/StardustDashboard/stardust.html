<div class="container body-content" ng-controller="summaryController as vm">
	<h2>Stardust Dashboard</h2>
	<div class="row">
		<div class="col-md-3">
			<div class="panel panel-default ">
				<div class="panel-heading">Trigger Resource Calculation</div>
				<div class="panel-body">
					<p>Don't trigger this Stardust job in a customer environment unless you know what you are doing! These jobs will take a lot of Stardust resources.</p>
					<div class="dropdown" style="padding-bottom: 10px">
						<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
							<span ng-show="!vm.selectedTenantName">Select Tenant...</span>
							<span ng-show="vm.selectedTenantName">{{vm.selectedTenantName}}</span>
							<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
							<li ng-repeat="tenant in vm.Tenants" ng-click="vm.selectTenant(tenant.Name)"><a>{{tenant.Name}}</a></li>
						</ul>
					</div>
					<div class="row" style="padding: 10px">
						<button class="btn btn-primary" ng-disabled="!vm.selectedTenantName" ng-click="vm.triggerResourceCalculation()">
							<span class="text-white">Trigger Resource Calculation &raquo;</span>
						</button>
					</div>
				</div>
			</div>
			<div class="panel panel-default ">
				<div class="panel-heading">Run Health Check</div>
				<div class="panel-body">
					<p>
						Do you suspect something is wrong with Stardust? Run the Healthcheck and see if there is any communication issues!
						<br/>
						<br/>
						<button class="btn btn-primary" ng-click="vm.healthCheck()">
							<span class="text-white">Health Check &raquo;</span>
						</button>
						<br/>
						<br/>
						<md-icon md-svg-src="Content/images/error_alert_24px.svg" style="display:{{vm.showHealthAlert}}"></md-icon> {{vm.result}}
					</p>
				</div>
			</div>
		</div>
		<div class="col-md-9">
			<div class="panel panel-default ">
				<div class="panel-heading">
					Failures  <md-icon md-svg-src="Content/images/error_alert_24px.svg" style="display:{{vm.showFailureAlert}}"></md-icon> 
				</div>
				<div class="panel-body">
					<table style="display:{{vm.displayFailedJobs}}">
						<thead>
						<tr>
							<th>Tenant</th>
							<th>Type</th>
							<th>Started (UTC)</th>
							<th>Sent to</th>
							<th>Result</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="job in vm.FailedJobs">
							<td>{{job.DataSource}}</td>
							<td><a href="#StardustDashboard/jobs/{{job.JobId}}">{{job.Name}}</a></td>
							<td>{{job.Started | date : 'yyyy-MM-dd HH:mm:ss'}}</td>
							<td>{{job.SentToWorkerNodeUri}}</td>
							<td ng-class="job.Result=='Success' ? 'green' : (job.Result==null ? 'hide' : 'red')">{{job.Result}}</td>
						</tr>
						</tbody>
					</table>
					<p>{{vm.noFailedJobsMessage}}</p>
					<a class="button" href="#StardustDashboard/failedJobs" style="display:{{vm.displayFailedJobs}}">See more results &raquo;</a>
				</div>
			</div>
			<div class="panel panel-default ">
				<div class="panel-heading">Queue
				</div>
				<div class="panel-body">
					<table style="display:{{vm.displayQueuedJobs}}">
						<thead>
						<tr>
							<th>Tenant</th>
							<th>Type</th>
							<th>Created (UTC)</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="job in vm.QueuedJobs">
							<td>{{job.DataSource}}</td>
							<td><a href="#StardustDashboard/queue/{{job.JobId}}">{{job.Name}}</a></td>
							<td>{{job.CreatedBy}} {{job.Created | date : 'yyyy-MM-dd HH:mm:ss'}}</td>
						</tr>
						</tbody>
					</table>
					<p>{{vm.noQueuedJobsMessage}}</p>
					<a class="button" href="#StardustDashboard/queue" style="display:{{vm.displayQueuedJobs}}">See more results &raquo;</a>
				</div>
			</div>
			<div class="panel panel-default">
				<div class="panel-heading">History</div>
				<div class="panel-body ">
					<table style="display:{{vm.displayHistory}}">
						<thead>
						<tr>
							<th>Tenant</th>
							<th>Type</th>
							<th>Started (UTC)</th>
							<th>Sent to</th>
							<th>Result</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-repeat="job in vm.RunningJobs">
							<td>{{job.DataSource}}</td>
							<td><a href="#StardustDashboard/jobs/{{job.JobId}}">{{job.Name}}</a></td>
							<td>{{job.Started | date : 'yyyy-MM-dd HH:mm:ss'}}</td>
							<td>{{job.SentToWorkerNodeUri}}</td>
							<td ng-class="job.Result=='Success' ? 'green' : (job.Result==null ? 'hide' : 'red')">{{job.Result}}</td>
						</tr>
						</tbody>
					</table>
					<p><md-icon md-svg-src="Content/images/error_alert_24px.svg" style="display:{{vm.showHistoryAlert}}"></md-icon>   {{vm.noHistoryMessage}}</p>
					<a class="button" href="#StardustDashboard/jobs" style="display:{{vm.displayHistory}}">See more results &raquo;</a>
				</div>
			</div>
			<div class="panel panel-default ">
				<div class="panel-heading">Nodes</div>
				<div class="panel-body">
					<table style="display:{{vm.displayNodes}}">
						<thead>
						<tr>
							<th>Url</th>
							<th>Latest Heartbeat (UTC)</th>
							<th>Working</th>
							<th>Alive</th>
						</tr>
						</thead>
						<tbody>
						<tr ng-class="{'greenNode': node.Alive === true, 'redNode': node.Alive === false}" ng-repeat="node in vm.WorkerNodes">
							<td><a href="#StardustDashboard/nodes/{{node.Id}}">{{node.Url}}</a></td>
							<td>{{node.Heartbeat | date : 'yyyy-MM-dd HH:mm:ss'}}</td>
							<td>{{node.Running}}</td>
							<td ng-class="node.Alive === true ? 'green' : 'red'">{{node.Alive}}</td>
						</tr>
						</tbody>
					</table>
					<p><md-icon md-svg-src="Content/images/error_alert_24px.svg" style="display:{{vm.showNodesAlert}}"></md-icon>   {{vm.noNodesMessage}}</p>
					<a class="button" href="#StardustDashboard/nodes" style="display:{{vm.displayNodes}}">See more results &raquo;</a>
				</div>
			</div>
		</div>
	</div>
</div>

