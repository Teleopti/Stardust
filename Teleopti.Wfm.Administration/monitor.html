<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Monitor TeleoptiWFM</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			font-size: 14px;
			color: #444;
		}

		table {
			border: 2px solid;
			border-radius: 3px;
		}

		th {
			text-align: left;
			background-color: #dddddd;
		}
		
		th, td {
			min-width: 120px;
			padding: 10px;
		}
		
		.stepSuccess {
			color : green;
		}
		.stepFailure{
			color : red;
		}
	</style>
	<script src="Scripts/vue.min.js"></script>
	<script src="Scripts/axios.min.js"></script>
</head>
<body>
<div id="steps">
	<table>
		<thead>
			<tr>
				<th>Step Name</th>
				<th>Result</th>
			</tr>
		</thead>
		<tbody>
			<tr v-for="step in steps">
				<td>
					<div v-bind:class="outputColor(step.stepSuccess)">{{step.stepName}}</div>
				</td>
				<td>
					<div v-bind:class="outputColor(step.stepSuccess)">{{step.output}}</div>
				</td>
			</tr>
		</tbody>
	</table>
</div>
</body>

<script>
	var vm = new Vue({
		el: '#steps',
		data: {
			steps: []
		},
		mounted() {
			axios.get('/monitor/list')
					.then(monitorSteps => {
				monitorSteps.data.forEach(function (step) {
					vm.$data.steps.push({
						stepName: step,
						stepSuccess : false,
						output: 'Loading...'
					});
					axios.get('/monitor/check/' + step)
							.then(result => {
						var stepToUse = vm.$data.steps.find(function (stepToFind) {
							return stepToFind.stepName === step;
						});
					stepToUse.output = result.data;
					stepToUse.stepSuccess = true;
				})
					.catch(error => {
						var stepToUse = vm.$data.steps.find(function (stepToFind) {
							return stepToFind.stepName === step;
						});
					stepToUse.output = error.response.data;
					})
				});
		});
		},
		methods : {
			outputColor : function(value){
				return value ? 'stepSuccess' : 'stepFailure';
			}
		}
	});
</script>
</html>