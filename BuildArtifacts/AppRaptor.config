<configuration>
	<configSections>
		<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net" />
		<section name="serverInstallations" type="Teleopti.Ccc.SmartClientPortal.Shell.ConfigurationSections.ServerInstallations, Teleopti.Ccc.SmartClientPortal.Shell" />
	</configSections>
	<startup>
		<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.6.1"/>
	</startup>
	<!--
	To run desktop client against multiple installations please uncomment sections below and add appropriate info.

  You can do this centrally in the click once folder, but remember to manually re-sign the deploy afterwards. How to:
  When the server installation is complete, navigate to the place on disc where the Admin client files are stored, normally C:\Program Files (x86)\Teleopti\TeleoptiCCC\Client
  Open the file Teleopti.Ccc.SmartClientPortal.Shell.exe.config.deploy, (this file!), just with a deploy extension.
  Uncomment one section per installation below and change from TheServer to your server name.
  Remember to use https when needed.
  Now you have modified the signed ClickOnce file and they are invalid so we need to sign them again. We will do that using a tool called ClickOnceSign.exe. You find that application under C:\Program Files (x86)\Teleopti\ClickOnce. Start the application.
  Press Browse button and point out the path where the client files are stored. That´s the same folder where we modified the config file, typically, C:\Program Files (x86)\Teleopti\TeleoptiCCC\Client.
  When you have done that the application will fill in the 2 text boxes below. Leave them like that. In the field “Provider URL” you enter the URL to where the client files will be downloaded, 
  typically http://SERVERNAME/TeleoptiWFM/Client. The last step is to point out where the certificate is. We deploy a temporary certificate, TemporaryKey.pfx, found in folder C:\Program Files (x86)\Teleopti\ClickOnce. 
  Just point to that and leave the Password field empty. If the customer has its own certificate, point to that and apply the appropriate password.
  Uninstall the client, if you had it installed, and then reinstall it again.
	-->
	<!--
	<serverInstallations>
		<installations>
			<installation name="name-of-installation-1">
				<overrides>
					<appSetting key="FeatureToggle" value="http://TheServer/TeleoptiWFM/Web/" />
					<appSetting key="TenantServer" value="http://TheServer/TeleoptiWFM/Web/" />
					<appSetting key="ReportServer" value="http://TheServer/TeleoptiWFM/Web/" />
					<appSetting key="ConfigServer" value="http://TheServer/TeleoptiWFM/Web/" />
					<appSetting key="MatrixWebSiteUrl" value="http://TheServer/TeleoptiWFM/Analytics/" />
				</overrides>
			</installation>
			<installation name="name-of-installation-2">
				<overrides>
					<appSetting key="FeatureToggle" value="http://TheServer2/TeleoptiWFM/Web/" />
					<appSetting key="TenantServer" value="http://TheServer2/TeleoptiWFM/Web/" />
					<appSetting key="ReportServer" value="http://TheServer2/TeleoptiWFM/Web/" />
					<appSetting key="ConfigServer" value="http://TheServer2/TeleoptiWFM/Web/" />
					<appSetting key="MatrixWebSiteUrl" value="http://TheServer2/TeleoptiWFM/Analytics/" />
				</overrides>
			</installation>
		</installations>
	</serverInstallations>
	-->
	
	<log4net>
		<appender name="file" type="log4net.Appender.RollingFileAppender">
			<file value="TeleoptiErrorLog.txt" />
			<appendToFile value="true" />
			<rollingStyle value="Size" />
			<maxSizeRollBackups value="2" />
			<maximumFileSize value="1MB" />
			<staticLogFileName value="true" />
			<layout type="log4net.Layout.PatternLayout">
				<conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] - %message%newline" />
			</layout>
		</appender>
<appender name="aiAppender" type="Microsoft.ApplicationInsights.Log4NetAppender.ApplicationInsightsAppender, Microsoft.ApplicationInsights.Log4NetAppender">
    <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%message%newline" />
    </layout>
</appender>
    <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
      <bufferSize value="1" />
      <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
      <commandText value="INSERT INTO dbo.AdvancedLoggingService ([LogDate],[BU],[DataSource],[WindowsIdentity],[Message],[HostIP],[SkillDays],[Agents],[TeamOptions],[BlockOptions],[GeneralOptions],[ExecutionTime],[BUId]) 
                   VALUES (@log_date, @bu, @datasource, @windowsindentity, @message, @hostip, @SkillDays, @Agents, @TeamOptions, @BlockOptions, @GeneralOptions,@ExecutionTime,@BUId)" />
      <parameter>
        <parameterName value="@log_date" />
        <dbType value="DateTime" />
        <layout type="log4net.Layout.RawTimeStampLayout" />
      </parameter>
      <parameter>
        <parameterName value="@bu" />
        <dbType value="String" />
        <size value="50" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{BU}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@datasource" />
        <dbType value="String" />
        <size value="200" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{DataSource}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@windowsindentity" />
        <dbType value="String" />
        <size value="200" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{WindowsIdentity}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@message" />
        <dbType value="String" />
        <size value="100" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%message" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@hostip" />
        <dbType value="String" />
        <size value="30" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{HostIP}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@SkillDays" />
        <dbType value="Int32" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{SkillDays}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@Agents" />
        <dbType value="Int32" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{Agents}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@TeamOptions" />
        <dbType value="String" />
        <size value="500" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{TeamOptions}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@BlockOptions" />
        <dbType value="String" />
        <size value="500" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{BlockOptions}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@GeneralOptions" />
        <dbType value="String" />
        <size value="500" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{GeneralOptions}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@ExecutionTime" />
        <dbType value="Int32" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{ExecutionTime}" />
        </layout>
      </parameter>
      <parameter>
        <parameterName value="@BUId" />
        <dbType value="String" />
        <size value="36" />
        <layout type="log4net.Layout.PatternLayout">
          <conversionPattern value="%property{BUId}" />
        </layout>
      </parameter>
    </appender>
    
		<root>
			<level value="ERROR" />
			<appender-ref ref="file" />
			<appender-ref ref="aiAppender" />
		</root>

    <logger name="Teleopti.AdvanceLoggingService">
      <level value="INFO" />
      <appender-ref ref="AdoNetAppender" />
    </logger>

    <!--<logger name="Teleopti">
			<level value="INFO" />
		</logger>-->
	</log4net>

  <system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="SingleSignOnServiceSoap12">
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap12" writeEncoding="utf-8">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </textMessageEncoding>
                <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true">
                </httpTransport>
            </binding>
        </customBinding>
    </bindings>
    <client>
      <endpoint address="http://customer.teleopti.com/ws/singlesignonservice.asmx"
            binding="customBinding" bindingConfiguration="SingleSignOnServiceSoap12"
            contract="SingleSignOn.SingleSignOnServiceSoap" name="SingleSignOnServiceSoap12" />
    </client>
  </system.serviceModel>
  
  <!--Make Windows Client work from behind proxies as well-->
  <system.net>
    <defaultProxy useDefaultCredentials="true" />
  </system.net>
  
  <appSettings>
    <add key="ShowMem" value="false"/>
	<!--WISEMETA: value="[URL]"-->
	<add key="FeatureToggle" value="$(URL)"/>
	<!--WISEMETA: value="[URL]"-->
	<add key="TenantServer" value="$(URL)"/>
	<!--WISEMETA: value="[URL]"-->
	<add key="ReportServer" value="$(URL)"/>
	<!--WISEMETA: value="[URL]"-->
	<add key="ConfigServer" value="$(URL)"/>
	<!--WISEMETA: value="[MATRIX_WEB_SITE_URL]"-->
	<add key="MatrixWebSiteUrl" value="$(MATRIX_WEB_SITE_URL)"/>
	<!--WISEMETA: value="[LOCAL_WIKI]"-->
	<add key="HelpUrl" value="$(LOCAL_WIKI)"/>
	<add key="HelpPrefix" value="F01%253A"/>
    <add key="HelpDivider" value="_"/>
    <add key="HelpSuffix" value=".html"/>
	<add key="HelpUrlOnline" value="https://wiki.teleopti.com/TeleoptiWFM/Special:MyLanguage/"/>
    <add key="HelpPrefixOnline" value="f01:"/>
    <add key="HelpDividerOnline" value="+"/>
    <add key="HelpSuffixOnline" value=""/>
	<!--WISEMETA: value="[URL]StardustDashboard/"-->
	<add key="ManagerLocation" value="$(URL)StardustDashboard/"/>
	<!--Configuration to handle EO browser child processes -->
	<add key="EOEnableLargeAddressSpace" value="false" />
  </appSettings>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="Autofac" publicKeyToken="17863af14b0044da" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-3.5.0.0" newVersion="3.5.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Castle.Core" publicKeyToken="407dd0808d44fbdc" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-3.3.0.0" newVersion="3.3.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Common.Logging" publicKeyToken="af08829b84f0328e" culture="neutral"/>
        <bindingRedirect oldVersion="0.0.0.0-2.2.0.0" newVersion="2.2.0.0"/>
      </dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="Newtonsoft.Json" publicKeyToken="30ad4fe6b2a6aeed" culture="neutral" />
				<bindingRedirect oldVersion="0.0.0.0-10.0.0.0" newVersion="10.0.0.0" />
			</dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="FSharp.Core"
                          publicKeyToken="b03f5f7f11d50a3a"
                          culture="neutral" />
        <!-- Redirecting to version 4.3.0.0 of the assembly. -->
        <bindingRedirect oldVersion="2.3.0.0"
                         newVersion="4.3.0.0"/>
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
</configuration>
