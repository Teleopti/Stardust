@using Teleopti.Ccc.UserTexts
@using Teleopti.Ccc.Web.Areas.MyTime.Core
@using Teleopti.Ccc.Web.Areas.MyTime.Models.StudentAvailability
@model StudentAvailabilityViewModel
@{
	Layout = null;
}

<div id="StudentAvailability-period" class="pd5 information-panel">
	@if (Model.StudentAvailabilityPeriod == null)
	{
		@String.Format("{0} : {1}", Resources.StudentAvailabilityPeriod, Resources.MissingWorkflowControlSet)
	}
	else
	{
		@String.Format("{0} : {1} | ", Resources.StudentAvailabilityPeriod, Model.StudentAvailabilityPeriod.Period)
		@String.Format("{0} : {1}", Resources.IsOpen, Model.StudentAvailabilityPeriod.OpenPeriod)
	}
</div>
<div id="StudentAvailability-body" class="body-calendarview clearfix" data-mytime-periodselection='@Html.Schedule().PeriodSelectionAsJson(Model.PeriodSelection)'>
	<style>
		@foreach (var style in Model.Styles)
		{
			@String.Format(".calendarview-week li.{0} div.day-content{{border-left-color: #{1}; border-right-color: #{1};}}\n", style.Name, style.ColorHex)
		}
	</style>
	<div id="StudentAvailability-body-inner" class="body-calendarview-inner clearfix">
		<ul class="weekdays">
			@foreach (var weekDayName in Model.WeekDayHeaders)
			{
				<li>@weekDayName.Title</li>
			}
		</ul>
		@foreach (var week in Model.Weeks)
		{
			<ul class="calendarview-week">
				<li>
					<div>
						<span>@week.Summary.MinWorkTime</span>
						<span>@week.Summary.MaxWorkTime</span>
					</div>
				</li>
				@foreach (var day in week.Days)
				{
					<li data-mytime-editable="@day.Editable" data-mytime-date="@Html.Schedule().FormatDate(day.Date)" class="relative @(day.InPeriod ? "inperiod" : "non-editable")" data-bind="css: {editable: Editable, 'non-editable': !Editable()}">
						<div>
							<div class="day-header">
								<span class="floatleft ml5">@day.Header.DayDescription</span><span class="floatright mr5">@day.Header.DayNumber</span>
							</div>
							<div class="day-content pdt10">
								<img class="loading-small-gray-blue" data-bind="visible: IsLoading" src="@Url.Content("~/Areas/MyTime/Content/Images/ajax-loader-small-f8f8f8.gif")" alt="..." />
								<!-- ko if: AjaxError().length > 0 -->
								<h2 class="error" data-bind="text: AjaxError"></h2>
								<!-- /ko -->
								<div class="fullwidth mt15" data-bind="text: AvailableTimeSpan">
								</div>
							</div>
						</div>
					</li>
				}
			</ul>
		}
	</div>
</div>