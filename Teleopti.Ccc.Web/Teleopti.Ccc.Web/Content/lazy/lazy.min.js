(function(n){function i(n){if(n instanceof Array)return new o(n);if(typeof n=="string")return new ut(n);if(n instanceof t)return n;if(i.extensions){for(var u=i.extensions,f=u.length,r;!r&&f--;)r=u[f](n);if(r)return r}return new b(n)}function t(){}function gt(n){this.sequence=n;this.index=-1}function st(n,t){this.parent=n;this.mapFn=t}function ni(n,t){this.iterator=n.getIterator();this.mapFn=t;this.index=-1}function l(n,t){this.parent=n;this.filterFn=t}function ti(n,t){this.iterator=n.getIterator();this.filterFn=t;this.index=0}function ii(n){this.parent=n}function ri(n){this.sequence=n}function ui(n,t){this.parent=n;this.arrays=t}function ht(n,t){this.parent=n;this.count=t}function fi(n,t){this.iterator=n.getIterator();this.count=t}function ei(n,t){this.parent=n;this.predicate=t}function oi(n,t){this.parent=n;this.count=typeof t=="number"?t:1}function si(n,t){this.parent=n;this.predicate=t}function hi(n,t){this.parent=n;this.sortFn=t}function ci(n,t){this.parent=n;this.keyFn=t}function li(n,t){this.parent=n;this.keyFn=t}function p(n,t){this.parent=n;this.keyFn=t}function ai(n,t){this.parent=n;this.arrays=t}function vi(n){this.parent=n}function yi(n){this.parent=n}function pi(n,t){this.parent=n;this.values=t}function wi(n,t){this.parent=n;this.arrays=t}function a(n){this.iterator=n;this.set=new y;this.memo=[];this.currentValue=undefined}function bi(n,t){this.parent=n;this.chunkSize=t}function ki(n,t){this.iterator=n.getIterator();this.size=t}function di(n,t){this.parent=n;this.callback=t}function w(n,t){this.parent=n;this.array=t;this.each=dr(t)}function dr(n){return n.length<40?w.prototype.eachArrayCache:w.prototype.eachMemoizerCache}function gi(n,t){this.parent=n;this.array=t}function u(){}function nr(n){this.sequence=n;this.index=-1}function d(n,t){this.parent=n;this.mapFn=t}function tr(n,t){this.parent=n;this.filterFn=t}function g(n){this.parent=n}function ir(n,t){this.parent=n;this.count=t}function ct(n,t){this.parent=n;this.count=typeof t=="number"?t:1}function lt(n,t){this.parent=n;this.other=t}function nt(n,t){this.parent=n;this.each=gr(n);this.keyFn=t}function gr(n){return n.length()<100?nt.prototype.eachArrayCache:p.prototype.each}function o(n){this.source=n}function tt(n,t){this.parent=n;this.mapFn=t}function rr(n,t){this.parent=n;this.filterFn=t}function c(n,t){this.parent=n;this.each=nu(n.source);this.keyFn=t}function nu(n){return n.length<40?c.prototype.eachNoCache:n.length<100?c.prototype.eachArrayCache:c.prototype.eachSetCache}function it(n,t){this.parent=n;this.other=t}function r(){}function at(n,t){this.parent=n;this.other=t}function vt(n,t){this.parent=n;this.defaults=t}function ur(n){this.parent=n}function fr(n,t,i){this.parent=n;this.others=t;this.mergeFn=i}function kr(n,t){if(typeof n!="object"||n===null)return typeof t!="undefined"?t:n;var r={};for(var i in n)r[i]=kr(n[i],t[i]);for(i in t)r[i]||(r[i]=t[i]);return r}function yt(n,t){this.parent=n;this.properties=t}function pt(n,t){this.parent=n;this.properties=t}function b(n){this.source=n}function f(){}function rt(n){this.source=i(n);this.index=-1}function wt(n,t,i){this.parent=n;this.start=Math.max(0,t);this.stop=i}function bt(n,t){this.parent=n;this.mapFn=t}function kt(n){this.parent=n}function er(n,t){this.source=n;this.pattern=t}function or(n,t){this.source=n;this.pattern=wr(t)}function sr(n,t){this.source=n;this.pattern=t}function hr(n,t){this.source=n;this.pattern=wr(t)}function cr(n,t){this.source=n;this.delimiter=t}function ut(n){this.source=n}function k(n,t){this.get=n;this.fixedLength=t}function lr(n){this.sequence=n;this.index=0;this.currentValue=null}function s(n,t){if(n instanceof s)throw"Sequence is already asynchronous!";this.parent=n;this.interval=t;this.onNextCallback=tu(t)}function v(n){this.cancelCallback=iu(n)}function tu(n){return typeof n=="undefined"&&typeof setImmediate=="function"?setImmediate:(n=n||0,function(t){return setTimeout(t,n)})}function iu(n){return typeof n=="undefined"&&typeof clearImmediate=="function"?clearImmediate:clearTimeout}function ar(n,t){this.listeners=[];t?t instanceof Array||(t=[t]):t=i(n).keys().toArray();var r=this.listeners,u=0;i(t).each(function(t){var i=n[t];Object.defineProperty(n,t,{get:function(){return i},set:function(n){for(var f=r.length-1;f>=0;--f)r[f]({property:t,value:n},u)===!1&&r.splice(f,1);i=n;++u}})})}function ft(){}function vr(n,t){this.parent=n;this.delimiter=t}function yr(n,t){this.parent=n;this.pattern=wr(t)}function e(n,t){switch(typeof n){case"function":return n;case"string":return function(t){return t[n]};case"object":return function(t){return i(n).all(function(n,i){return t[i]===n})};case"undefined":return t?function(){return t}:i.identity;default:throw"Don't know how to make a callback from a "+typeof n+"!";}}function uu(n){var t=new y;return i(n||[]).flatten().each(function(n){t.add(n)}),t}function pr(n,t,i){return typeof i=="function"?pr(i(n),i(t)):n===t?0:n>t?1:-1}function ot(n,t){for(var i=-1,r=n.length;++i<r;)if(t(n[i],i)===!1)return!1;return!0}function fu(n){var t;return n.each(function(n){return t=n,!1}),t}function h(n,t){var i=-1,r=n.length;if(t!==t){while(++i<r)if(n[i]!==n[i])return!0;return!1}while(++i<r)if(n[i]===t)return!0;return!1}function eu(n,t,i,r){var u=-1;if(r){for(r=e(r);++u<i;)if(r(n[u])===r(t))return!0}else while(++u<i)if(n[u]===t)return!0;return!1}function ou(n,t,i){var r=n[t];n[t]=n[i];n[i]=r}function wr(pattern){return eval(""+pattern+(pattern.global?"":"g"))}function y(){this.table={};this.objects=[]}function br(n){this.contents=new Array(n);this.start=0;this.count=0}function dt(n,t,i){var r=function(){},f,o,e,u;r.prototype=new n;for(f in i)r.prototype[f]=i[f];for(o=function(){var n=new r;return n.parent=this,n.init&&n.init.apply(n,arguments),n},e=typeof t=="string"?[t]:t,u=0;u<e.length;++u)n.prototype[e[u]]=o;return r}i.VERSION="0.3.1";i.noop=function(){};i.identity=function(n){return n};i.strict=function(){function n(n){if(n==null)throw"You cannot wrap null or undefined using Lazy.";if(typeof n=="number"||typeof n=="boolean")throw"You cannot wrap primitive values using Lazy.";return i(n)}return i(i).each(function(t,i){n[i]=t}),n};t.define=function(n,i){if(!i||!i.getIterator&&!i.each)throw"A custom sequence must implement *at least* getIterator or each!";return dt(t,n,i)};t.prototype.size=function(){return this.getIndex().length()};t.prototype.getIterator=function(){return new gt(this)};t.prototype.root=function(){return this.parent.root()};t.prototype.value=function(){return this.toArray()};t.prototype.apply=function(n){var t=this.root(),r=t.source,i;try{t.source=n;i=this.value()}finally{t.source=r}return i};gt.prototype.current=function(){return this.cachedIndex&&this.cachedIndex.get(this.index)};gt.prototype.moveNext=function(){var n=this.cachedIndex;return(n||(n=this.cachedIndex=this.sequence.getIndex()),this.index>=n.length()-1)?!1:(++this.index,!0)};t.prototype.toArray=function(){return this.reduce(function(n,t){return n.push(t),n},[])};t.prototype.getIndex=function(){return this.cachedIndex||(this.cachedIndex=new o(this.toArray())),this.cachedIndex};t.prototype.toObject=function(){return this.reduce(function(n,t){return n[t[0]]=t[1],n},{})};t.prototype.each=function(n){for(var t=this.getIterator(),i=-1;t.moveNext();)if(n(t.current(),++i)===!1)return!1;return!0};t.prototype.forEach=function(n){return this.each(n)};t.prototype.map=function(n){return new st(this,e(n))};t.prototype.collect=function(n){return this.map(n)};st.prototype=new t;st.prototype.getIterator=function(){return new ni(this.parent,this.mapFn)};st.prototype.each=function(n){var t=this.mapFn;return this.parent.each(function(i,r){return n(t(i,r),r)})};ni.prototype.current=function(){return this.mapFn(this.iterator.current(),this.index)};ni.prototype.moveNext=function(){return this.iterator.moveNext()?(++this.index,!0):!1};t.prototype.pluck=function(n){return this.map(n)};t.prototype.invoke=function(n){return this.map(function(t){return t[n]()})};t.prototype.filter=function(n){return new l(this,e(n))};t.prototype.select=function(n){return this.filter(n)};l.prototype=new t;l.prototype.getIterator=function(){return new ti(this.parent,this.filterFn)};l.prototype.each=function(n){var t=this.filterFn;return this.parent.each(function(i,r){if(t(i,r))return n(i,r)})};l.prototype.reverse=function(){return this.parent.reverse().filter(this.filterFn)};ti.prototype.current=function(){return this.value};ti.prototype.moveNext=function(){for(var t=this.iterator,i=this.filterFn,n;t.moveNext();)if(n=t.current(),i(n,this.index++))return this.value=n,!0;return this.value=undefined,!1};t.prototype.reject=function(n){return this.filter(function(t){return!n(t)})};t.prototype.ofType=function(n){return this.filter(function(t){return typeof t===n})};t.prototype.where=function(n){return this.filter(n)};t.prototype.reverse=function(){return new ii(this)};ii.prototype=new t;ii.prototype.getIterator=function(){return new ri(this.parent)};ri.prototype.current=function(){return this.sequence.getIndex().get(this.index)};ri.prototype.moveNext=function(){var n=this.sequence.getIndex(),t=n.length();return typeof this.index=="undefined"&&(this.index=t),--this.index>=0};t.prototype.concat=function(){return new ui(this,et.call(arguments,0))};ui.prototype=new t;ui.prototype.each=function(n){var t=!1,r=0;this.parent.each(function(i){if(n(i,r++)===!1)return t=!0,!1});t||i(this.arrays).flatten().each(function(t){if(n(t,r++)===!1)return!1})};t.prototype.first=function(n){return typeof n=="undefined"?fu(this):new ht(this,n)};t.prototype.head=t.prototype.take=function(n){return this.first(n)};ht.prototype=new t;ht.prototype.getIterator=function(){return new fi(this.parent,this.count)};ht.prototype.each=function(n){var i=this.count,t=0;this.parent.each(function(r){var u;return(t<i&&(u=n(r,t)),++t>=i)?!1:u})};fi.prototype.current=function(){return this.iterator.current()};fi.prototype.moveNext=function(){return--this.count>=0&&this.iterator.moveNext()};t.prototype.takeWhile=function(n){return new ei(this,n)};ei.prototype=new t;ei.prototype.each=function(n){var t=this.predicate;this.parent.each(function(i){return t(i)&&n(i)})};t.prototype.initial=function(n){return typeof n=="undefined"&&(n=1),this.take(this.getIndex().length()-n)};t.prototype.last=function(n){return typeof n=="undefined"?this.reverse().first():this.reverse().take(n).reverse()};t.prototype.findWhere=function(n){return this.where(n).first()};t.prototype.rest=function(n){return new oi(this,n)};t.prototype.skip=t.prototype.tail=t.prototype.drop=function(n){return this.rest(n)};oi.prototype=new t;oi.prototype.each=function(n){var t=this.count,i=0,r=0;this.parent.each(function(u){if(!(i++<t))return n(u,r++)})};t.prototype.dropWhile=function(n){return new si(this,n)};t.prototype.skipWhile=function(n){return this.dropWhile(n)};si.prototype=new t;si.prototype.each=function(n){var i=this.predicate,t=!1;this.parent.each(function(r){if(!t){if(i(r))return;t=!0}return n(r)})};t.prototype.sortBy=function(n){return new hi(this,n)};hi.prototype=new t;hi.prototype.each=function(n){var i=e(this.sortFn),t=this.parent.toArray();return t.sort(function(n,t){return pr(n,t,i)}),ot(t,n)};t.prototype.groupBy=function(n){return new ci(this,n)};t.prototype.countBy=function(n){return new li(this,n)};t.prototype.uniq=function(n){return new p(this,n)};t.prototype.unique=function(n){return this.uniq(n)};p.prototype=new t;p.prototype.each=function(n){var i=new y,t=this.keyFn,r=0;return t?(t=e(t),this.parent.each(function(u){if(i.add(t(u)))return n(u,r++)})):this.parent.each(function(t){if(i.add(t))return n(t,r++)})};t.prototype.zip=function(n){return arguments.length===1?new gi(this,n):new ai(this,et.call(arguments,0))};ai.prototype=new t;ai.prototype.each=function(n){var t=this.arrays,i=0;this.parent.each(function(r){for(var f=[r],u=0;u<t.length;++u)t[u].length>i&&f.push(t[u][i]);return n(f,i++)})};t.prototype.shuffle=function(){return new vi(this)};vi.prototype=new t;vi.prototype.each=function(n){for(var i=this.parent.toArray(),u=Math.floor,f=Math.random,r=0,t=i.length-1;t>0;--t)if(ou(i,t,u(f()*t)+1),n(i[t],r++)===!1)return;n(i[0],r)};t.prototype.flatten=function(){return new yi(this)};yi.prototype=new t;yi.prototype.each=function(n){var r=0;return this.parent.each(function i(u){return u instanceof Array?ot(u,i):u instanceof t?u.each(i):n(u,r++)})};t.prototype.compact=function(){return this.filter(function(n){return!!n})};t.prototype.without=function(){return new pi(this,et.call(arguments,0))};t.prototype.difference=function(){return this.without.apply(this,arguments)};pi.prototype=new t;pi.prototype.each=function(n){var t=uu(this.values),i=0;return this.parent.each(function(r){if(!t.contains(r))return n(r,i++)})};t.prototype.union=function(n){return this.concat(n).uniq()};t.prototype.intersection=function(n){return arguments.length===1&&arguments[0]instanceof Array?new w(this,n):new wi(this,et.call(arguments,0))};wi.prototype=new t;wi.prototype.each=function(n){var t=i(this.arrays).map(function(n){return new a(i(n).getIterator())}),r=new a(t.getIterator()),u=0;return this.parent.each(function(t){var i=!0;return r.each(function(n){if(!n.contains(t))return i=!1,!1}),i?n(t,u++):void 0})};a.prototype.current=function(){return this.currentValue};a.prototype.moveNext=function(){for(var t=this.iterator,i=this.set,r=this.memo,n;t.moveNext();)if(n=t.current(),i.add(n))return r.push(n),this.currentValue=n,!0;return!1};a.prototype.each=function(n){for(var i=this.memo,r=i.length,t=-1;++t<r;)if(n(i[t],t)===!1)return!1;while(this.moveNext())if(n(this.currentValue,t++)===!1)break};a.prototype.contains=function(n){if(this.set.contains(n))return!0;while(this.moveNext())if(this.currentValue===n)return!0;return!1};t.prototype.every=function(n){return this.each(e(n))};t.prototype.all=function(n){return this.every(n)};t.prototype.some=function(n){n=e(n,!0);var t=!1;return this.each(function(i){if(n(i))return t=!0,!1}),t};t.prototype.any=function(n){return this.some(n)};t.prototype.isEmpty=function(){return!this.any()};t.prototype.indexOf=function(n){var t=-1;return this.each(function(i,r){if(i===n)return t=r,!1}),t};t.prototype.lastIndexOf=function(n){var t=this.reverse().indexOf(n);return t!==-1&&(t=this.getIndex().length()-t-1),t};t.prototype.sortedIndex=function(n){for(var u=this.getIndex(),t=0,r=u.length(),i;t<r;)i=t+r>>>1,pr(u.get(i),n)===-1?t=i+1:r=i;return t};t.prototype.contains=function(n){return this.indexOf(n)!==-1};t.prototype.reduce=function(n,t){return arguments.length<2?this.tail().reduce(n,this.head()):(this.each(function(i,r){t=n(t,i,r)}),t)};t.prototype.inject=t.prototype.foldl=function(n,t){return this.reduce(n,t)};t.prototype.reduceRight=function(n,t){if(arguments.length<2)return this.initial(1).reduceRight(n,this.last());var i=this.getIndex().length()-1;return this.reverse().reduce(function(t,r){return n(t,r,i--)},t)};t.prototype.foldr=function(n,t){return this.reduceRight(n,t)};t.prototype.consecutive=function(n){var t=new br(n),i=this.map(function(i){if(t.add(i).count===n)return t.toArray()});return i.compact()};t.prototype.chunk=function(n){if(n<1)throw"You must specify a positive chunk size.";return new bi(this,n)};bi.prototype=new t;bi.prototype.getIterator=function(){return new ki(this.parent,this.chunkSize)};ki.prototype.current=function(){return this.currentChunk};ki.prototype.moveNext=function(){for(var t=this.iterator,i=this.size,n=[];n.length<i&&t.moveNext();)n.push(t.current());return n.length===0?!1:(this.currentChunk=n,!0)};t.prototype.tap=function(n){return new di(this,n)};di.prototype=new t;di.prototype.each=function(n){var t=this.callback;return this.parent.each(function(i,r){return t(i,r),n(i,r)})};t.prototype.find=function(n){return this.filter(n).first()};t.prototype.detect=function(n){return this.find(n)};t.prototype.min=function(n){return typeof n!="undefined"?this.minBy(n):this.reduce(function(n,t){return t<n?t:n},Infinity)};t.prototype.minBy=function(n){return n=e(n),this.reduce(function(t,i){return n(i)<n(t)?i:t})};t.prototype.max=function(n){return typeof n!="undefined"?this.maxBy(n):this.reduce(function(n,t){return t>n?t:n},-Infinity)};t.prototype.maxBy=function(n){return n=e(n),this.reduce(function(t,i){return n(i)>n(t)?i:t})};t.prototype.sum=function(n){return typeof n!="undefined"?this.sumBy(n):this.reduce(function(n,t){return n+t},0)};t.prototype.sumBy=function(n){return n=e(n),this.reduce(function(t,i){return t+n(i)},0)};t.prototype.join=function(n){return n=typeof n=="string"?n:",",this.reduce(function(t,i){return t.length>0&&(t+=n),t+i},"")};t.prototype.toString=function(n){return this.join(n)};t.prototype.async=function(n){return new s(this,n)};w.prototype=new t;w.prototype.eachMemoizerCache=function(n){var t=new a(i(this.array).getIterator()),r=0;return this.parent.each(function(i){if(t.contains(i))return n(i,r++)})};w.prototype.eachArrayCache=function(n){var t=this.array,i=h,r=0;return this.parent.each(function(u){if(i(t,u))return n(u,r++)})};gi.prototype=new t;gi.prototype.each=function(n){var t=this.array;return this.parent.each(function(i,r){return n([i,t[r]],r)})};u.prototype=new t;u.define=function(n,t){if(!t||typeof t.get!="function")throw"A custom array-like sequence must implement *at least* get!";return dt(u,n,t)};u.prototype.get=function(n){return this.parent.get(n)};u.prototype.length=function(){return this.parent.length()};u.prototype.getIndex=function(){return this};u.prototype.getIterator=function(){return new nr(this)};nr.prototype.current=function(){return this.sequence.get(this.index)};nr.prototype.moveNext=function(){return this.index>=this.sequence.length()-1?!1:(++this.index,!0)};u.prototype.each=function(n){for(var i=this.length(),t=-1;++t<i;)if(n(this.get(t),t)===!1)return!1;return!0};u.prototype.pop=function(){return this.initial()};u.prototype.shift=function(){return this.drop()};u.prototype.slice=function(n,t){var r=this.length(),i;return n<0&&(n=r+n),i=this.drop(n),typeof t=="number"&&(t<0&&(t=r+t),i=i.take(t-n)),i};u.prototype.map=function(n){return new d(this,e(n))};d.prototype=new u;d.prototype.get=function(n){return n<0||n>=this.parent.length()?undefined:this.mapFn(this.parent.get(n),n)};u.prototype.filter=function(n){return new tr(this,e(n))};tr.prototype=new l;tr.prototype.each=function(n){for(var r=this.parent,u=this.filterFn,f=this.parent.length(),t=-1,i;++t<f;)if(i=r.get(t),u(i,t)&&n(i,t)===!1)return!1;return!0};u.prototype.reverse=function(){return new g(this)};g.prototype=new u;g.prototype.get=function(n){return this.parent.get(this.length()-n-1)};u.prototype.first=function(n){return typeof n=="undefined"?this.get(0):new ir(this,n)};ir.prototype=new u;ir.prototype.length=function(){var n=this.parent.length();return this.count<=n?this.count:n};u.prototype.rest=function(n){return new ct(this,n)};ct.prototype=new u;ct.prototype.get=function(n){return this.parent.get(this.count+n)};ct.prototype.length=function(){var n=this.parent.length();return this.count<=n?n-this.count:0};u.prototype.concat=function(n){return arguments.length===1&&arguments[0]instanceof Array?new lt(this,n):t.prototype.concat.apply(this,arguments)};lt.prototype=new u;lt.prototype.get=function(n){var t=this.parent.length();return n<t?this.parent.get(n):this.other[n-t]};lt.prototype.length=function(){return this.parent.length()+this.other.length};u.prototype.uniq=function(n){return new nt(this,e(n))};nt.prototype=new t;nt.prototype.eachArrayCache=function(n){for(var r=this.parent,e=this.keyFn,o=r.length(),u=[],s=h,t,i,f=-1,c=0;++f<o;)if(i=r.get(f),t=e(i),!s(u,t)&&(u.push(t),n(i,c++)===!1))return!1};nt.prototype.eachSetCache=p.prototype.each;o.prototype=new u;o.prototype.root=function(){return this};o.prototype.get=function(n){return this.source[n]};o.prototype.length=function(){return this.source.length};o.prototype.each=function(n){return ot(this.source,n)};o.prototype.map=o.prototype.collect=function(n){return new tt(this,e(n))};o.prototype.filter=o.prototype.select=function(n){return new rr(this,e(n))};o.prototype.uniq=o.prototype.unique=function(n){return new c(this,n)};o.prototype.concat=function(n){return arguments.length===1&&arguments[0]instanceof Array?new it(this,n):u.prototype.concat.apply(this,arguments)};o.prototype.toArray=function(){return this.source.slice(0)};tt.prototype=new u;tt.prototype.get=function(n){var t=this.parent.source;return n<0||n>=t.length?undefined:this.mapFn(t[n])};tt.prototype.length=function(){return this.parent.source.length};tt.prototype.each=function(n){for(var i=this.parent.source,r=i.length,u=this.mapFn,t=-1;++t<r;)if(n(u(i[t],t),t)===!1)return!1;return!0};rr.prototype=new l;rr.prototype.each=function(n){for(var r=this.parent.source,u=this.filterFn,f=r.length,t=-1,i;++t<f;)if(i=r[t],u(i,t)&&n(i,t)===!1)return!1;return!0};c.prototype=new t;c.prototype.eachNoCache=function(n){for(var t=this.parent.source,u=this.keyFn,f=t.length,e=eu,i,r=-1,o=0;++r<f;)if(i=t[r],!e(t,i,r,u)&&n(i,o++)===!1)return!1;return!0};c.prototype.eachArrayCache=function(n){var f=this.parent.source,i=this.keyFn,s=f.length,r=[],c=h,o,t,u=-1,l=0;if(i){for(i=e(i);++u<s;)if(t=f[u],o=i(t),!c(r,o)&&(r.push(o),n(t,l++)===!1))return!1}else while(++u<s)if(t=f[u],!c(r,t)&&(r.push(t),n(t,l++)===!1))return!1;return!0};c.prototype.eachSetCache=p.prototype.each;it.prototype=new u;it.prototype.get=function(n){var t=this.parent.source,i=t.length;return n<i?t[n]:this.other[n-i]};it.prototype.length=function(){return this.parent.source.length+this.other.length};it.prototype.each=function(n){for(var i=this.parent.source,f=i.length,r=this.other,e=r.length,u=0,t=-1;++t<f;)if(n(i[t],u++)===!1)return!1;for(t=-1;++t<e;)if(n(r[t],u++)===!1)return!1;return!0};r.prototype=new t;r.define=function(n,t){if(!t||typeof t.each!="function")throw"A custom object-like sequence must implement *at least* each!";return dt(r,n,t)};r.prototype.value=function(){return this.toObject()};r.prototype.get=function(n){var t=this.pairs().find(function(t){return t[0]===n});return t?t[1]:undefined};r.prototype.keys=function(){return this.map(function(n,t){return t})};r.prototype.values=function(){return this.map(function(n){return n})};r.prototype.async=function(){throw"An ObjectLikeSequence does not support asynchronous iteration.";};r.prototype.reverse=function(){return this};r.prototype.assign=function(n){return new at(this,n)};r.prototype.extend=function(n){return this.assign(n)};at.prototype=new r;at.prototype.get=function(n){return this.other[n]||this.parent.get(n)};at.prototype.each=function(n){var t=new y,r=!1;return i(this.other).each(function(i,u){if(n(i,u)===!1)return r=!0,!1;t.add(u)}),r?void 0:this.parent.each(function(i,r){if(!t.contains(r)&&n(i,r)===!1)return!1})};r.prototype.defaults=function(n){return new vt(this,n)};vt.prototype=new r;vt.prototype.get=function(n){return this.parent.get(n)||this.defaults[n]};vt.prototype.each=function(n){var t=new y,r=!1;this.parent.each(function(i,u){if(n(i,u)===!1)return r=!0,!1;typeof i!="undefined"&&t.add(u)});r||i(this.defaults).each(function(i,r){if(!t.contains(r)&&n(i,r)===!1)return!1})};r.prototype.invert=function(){return new ur(this)};ur.prototype=new r;ur.prototype.each=function(n){this.parent.each(function(t,i){return n(i,t)})};r.prototype.merge=function(){var n=arguments.length>1&&typeof arguments[arguments.length-1]=="function"?ru.call(arguments):null;return new fr(this,et.call(arguments,0),n)};fr.prototype=new r;fr.prototype.each=function(n){var r=this.others,u=this.mergeFn||kr,f={},e=this.parent.each(function(t,i){var e=t;return ot(r,function(n){i in n&&(e=u(e,n[i]))}),f[i]=!0,n(e,i)}),t;return e===!1?!1:(t={},ot(r,function(n){for(var i in n)f[i]||(t[i]=u(t[i],n[i]))}),i(t).each(n))};r.prototype.functions=function(){return this.filter(function(n){return typeof n=="function"}).map(function(n,t){return t})};r.prototype.methods=function(){return this.functions()};r.prototype.pick=function(n){return new yt(this,n)};yt.prototype=new r;yt.prototype.get=function(n){return h(this.properties,n)?this.parent.get(n):undefined};yt.prototype.each=function(n){var t=h,i=this.properties;return this.parent.each(function(r,u){if(t(i,u))return n(r,u)})};r.prototype.omit=function(n){return new pt(this,n)};pt.prototype=new r;pt.prototype.get=function(n){return h(this.properties,n)?undefined:this.parent.get(n)};pt.prototype.each=function(n){var t=h,i=this.properties;return this.parent.each(function(r,u){if(!t(i,u))return n(r,u)})};r.prototype.pairs=function(){return this.map(function(n,t){return[t,n]})};r.prototype.toArray=function(){return this.pairs().toArray()};r.prototype.toObject=function(){return this.reduce(function(n,t,i){return n[i]=t,n},{})};ci.prototype=new r;ci.prototype.each=function(n){var r=e(this.keyFn),t={},i;this.parent.each(function(n){var i=r(n);t[i]?t[i].push(n):t[i]=[n]});for(i in t)if(n(t[i],i)===!1)return!1;return!0};li.prototype=new r;li.prototype.each=function(n){var r=e(this.keyFn),t={},i;this.parent.each(function(n){var i=r(n);t[i]?t[i]+=1:t[i]=1});for(i in t)if(n(t[i],i)===!1)return!1;return!0};r.prototype.watch=function(){throw"You can only call #watch on a directly wrapped object.";};b.prototype=new r;b.prototype.root=function(){return this};b.prototype.get=function(n){return this.source[n]};b.prototype.each=function(n){var t=this.source;for(var i in t)if(n(t[i],i)===!1)return!1;return!0};f.prototype=new u;f.define=function(n,t){if(!t||typeof t.get!="function")throw"A custom string-like sequence must implement *at least* get!";return dt(f,n,t)};f.prototype.value=function(){return this.toString()};f.prototype.getIterator=function(){return new rt(this)};rt.prototype.current=function(){return this.source.charAt(this.index)};rt.prototype.moveNext=function(){return++this.index<this.source.length()};f.prototype.charAt=function(n){return this.get(n)};f.prototype.charCodeAt=function(n){var t=this.charAt(n);return t?t.charCodeAt(0):NaN};f.prototype.substring=function(n,t){return new wt(this,n,t)};wt.prototype=new f;wt.prototype.get=function(n){return this.parent.get(n+this.start)};wt.prototype.length=function(){return(typeof this.stop=="number"?this.stop:this.parent.length())-this.start};f.prototype.first=function(n){return typeof n=="undefined"?this.charAt(0):this.substring(0,n)};f.prototype.last=function(n){return typeof n=="undefined"?this.charAt(this.length()-1):this.substring(this.length()-n)};f.prototype.drop=function(n){return this.substring(n)};f.prototype.indexOf=function(n,t){return this.toString().indexOf(n,t)};f.prototype.lastIndexOf=function(n,t){return this.toString().lastIndexOf(n,t)};f.prototype.contains=function(n){return this.indexOf(n)!==-1};f.prototype.endsWith=function(n){return this.substring(this.length()-n.length).toString()===n};f.prototype.startsWith=function(n){return this.substring(0,n.length).toString()===n};f.prototype.toUpperCase=function(){return this.mapString(function(n){return n.toUpperCase()})};f.prototype.toLowerCase=function(){return this.mapString(function(n){return n.toLowerCase()})};f.prototype.mapString=function(n){return new bt(this,n)};bt.prototype=new f;bt.prototype.get=d.prototype.get;bt.prototype.length=d.prototype.length;f.prototype.reverse=function(){return new kt(this)};kt.prototype=new f;kt.prototype.get=g.prototype.get;kt.prototype.length=g.prototype.length;f.prototype.toString=function(){return this.join("")};f.prototype.match=function(n){return new er(this.source,n)};er.prototype=new t;er.prototype.getIterator=function(){return new or(this.source,this.pattern)};or.prototype.current=function(){return this.match[0]};or.prototype.moveNext=function(){return!!(this.match=this.pattern.exec(this.source))};f.prototype.split=function(n){return new sr(this.source,n)};sr.prototype=new t;sr.prototype.getIterator=function(){return this.pattern instanceof RegExp?this.pattern.source===""||this.pattern.source==="(?:)"?new rt(this.source):new hr(this.source,this.pattern):this.pattern===""?new rt(this.source):new cr(this.source,this.pattern)};hr.prototype.current=function(){return this.source.substring(this.start,this.end)};hr.prototype.moveNext=function(){if(!this.pattern)return!1;var n=this.pattern.exec(this.source);return n?(this.start=this.nextStart?this.nextStart:0,this.end=n.index,this.nextStart=n.index+n[0].length,!0):this.pattern?(this.start=this.nextStart,this.end=undefined,this.nextStart=undefined,this.pattern=undefined,!0):!1};cr.prototype.current=function(){return this.source.substring(this.leftIndex,this.rightIndex)};cr.prototype.moveNext=function(){return(this.finished||(this.leftIndex=typeof this.leftIndex!="undefined"?this.rightIndex+this.delimiter.length:0,this.rightIndex=this.source.indexOf(this.delimiter,this.leftIndex)),this.rightIndex===-1)?(this.finished=!0,this.rightIndex=undefined,!0):!this.finished};ut.prototype=new f;ut.prototype.root=function(){return this};ut.prototype.get=function(n){return this.source.charAt(n)};ut.prototype.length=function(){return this.source.length};k.prototype=new t;k.prototype.length=function(){return this.fixedLength};k.prototype.each=function(n){for(var r=this.get,t=this.fixedLength,i=0;typeof t=="undefined"||i<t;)if(n(r(i++))===!1)return!1;return!0};k.prototype.getIterator=function(){return new lr(this)};lr.prototype.current=function(){return this.currentValue};lr.prototype.moveNext=function(){var n=this.sequence;return typeof n.fixedLength=="number"&&this.index>=n.fixedLength?!1:(this.currentValue=n.get(this.index++),!0)};s.prototype=new t;s.prototype.each=function(n){var i=this.parent.getIterator(),r=this.onNextCallback,u=0,t=new v(this.interval);return t.id=r(function f(){try{i.moveNext()&&n(i.current(),u++)!==!1?t.id=r(f):t.completeCallback()}catch(e){t.errorCallback(e)}}),t};v.prototype.cancel=function(){var n=this.cancelCallback;this.id&&(n(this.id),this.id=null)};v.prototype.onError=function(n){this.errorCallback=n};v.prototype.errorCallback=i.noop;v.prototype.onComplete=function(n){this.completeCallback=n};v.prototype.completeCallback=i.noop;s.prototype.reverse=function(){return this.parent.reverse().async()};s.prototype.reduce=function(n,t){var i=this.each(function(i,r){t=typeof t=="undefined"&&r===0?i:n(t,i,r)});return i.then=i.onComplete=function(n){i.completeCallback=function(){n(t)}},i};s.prototype.find=function(n){var i,t=this.each(function(t,r){if(n(t,r))return i=t,!1});return t.then=t.onComplete=function(n){t.completeCallback=function(){n(i)}},t};s.prototype.indexOf=function(n){var i=-1,t=this.each(function(t,r){if(t===n)return i=r,!1});return t.then=t.onComplete=function(n){t.completeCallback=function(){n(i)}},t};s.prototype.contains=function(n){var i=!1,t=this.each(function(t){if(t===n)return i=!0,!1});return t.then=t.onComplete=function(n){t.completeCallback=function(){n(i)}},t};s.prototype.async=function(){return this};b.prototype.watch=function(n){return new ar(this.source,n)};ar.prototype=new s;ar.prototype.each=function(n){this.listeners.push(n)};ft.prototype=new s;ft.prototype.split=function(n){return new vr(this,n)};vr.prototype=new t;vr.prototype.each=function(n){var r=this.delimiter,t=!1,u=0;return this.parent.each(function(f){return i(f).split(r).each(function(i){if(n(i,u++)===!1)return t=!0,!1}),!t})};ft.prototype.lines=function(){return this.split("\n")};ft.prototype.match=function(n){return new yr(this,n)};yr.prototype=new s;yr.prototype.each=function(n){var r=this.pattern,t=!1,u=0;return this.parent.each(function(f){return i(f).match(r).each(function(i){if(n(i,u++)===!1)return t=!0,!1}),!t})};i.generate=function(n,t){return new k(n,t)};i.range=function(){var n=arguments.length>1?arguments[0]:0,i=arguments.length>1?arguments[1]:arguments[0],t=arguments.length>2?arguments[2]:1;return this.generate(function(i){return n+t*i}).take(Math.floor((i-n)/t))};i.repeat=function(n,t){return i.generate(function(){return n},t)};i.Sequence=t;i.ArrayLikeSequence=u;i.ObjectLikeSequence=r;i.StringLikeSequence=f;i.StreamLikeSequence=ft;i.GeneratedSequence=k;i.AsyncSequence=s;i.AsyncHandle=v;i.deprecate=function(n,t){return function(){return console.warn(n),t.apply(this,arguments)}};var ru=Array.prototype.pop,et=Array.prototype.slice;y.prototype.add=function(n){var t=this.table,r=typeof n,i;switch(r){case"number":case"boolean":case"undefined":return t[n]?!1:(t[n]=!0,!0);case"string":switch(n.charAt(0)){case"_":case"f":case"t":case"c":case"u":case"@":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"N":n="@"+n}return t[n]?!1:(t[n]=!0,!0);default:return(i=this.objects,!h(i,n))?(i.push(n),!0):!1}};y.prototype.contains=function(n){var t=typeof n;switch(t){case"number":case"boolean":case"undefined":return!!this.table[n];case"string":switch(n.charAt(0)){case"_":case"f":case"t":case"c":case"u":case"@":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"N":n="@"+n}return!!this.table[n];default:return h(this.objects,n)}};br.prototype.add=function(n){var t=this.contents,i=t.length,r=this.start;return this.count===i?(t[r]=n,this.start=(r+1)%i):t[this.count++]=n,this};br.prototype.toArray=function(){var i=this.contents,r=this.start,t=this.count,n=i.slice(r,r+t);return n.length<t&&(n=n.concat(i.slice(0,t-n.length))),n};typeof module=="object"&&module&&module.exports===n?module.exports=i:n.Lazy=i})(this);
/*
//# sourceMappingURL=lazy.min.js.map
*/