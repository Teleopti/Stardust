<div class="bank-holiday-settings panel material-depth-1 full-padding">
	<h2>
		<i nz-icon type="calendar" theme="outline"></i> {{ 'BankHolidayCalendars' | translate }}
		<button
			nz-button
			nz-tooltip
			*ngIf="!isAddingNewCalendar"
			nzType="primary"
			nzShape="circle"
			nzSize="large"
			[nzTitle]="'NewCalendar' | translate"
			(click)="startAddNewBankCalender()"
			class="add-bank-holiday-calendar-icon pull-right"
		>
			<i nz-icon type="plus" theme="outline"></i>
		</button>
	</h2>

	<nz-divider></nz-divider>

	<div *ngIf="isAddingNewCalendar" class="add-new-bank-holiday-calendar">
		<div class="con-row">
			<div class="con-flex">
				<div class="full-padding">
					<span class="inline-block">{{ 'Name' | translate }} :</span>
					<input
						nz-input
						[placeholder]="'Name' | translate"
						[(ngModel)]="newCalendarName"
						(blur)="checkNewCalendarName()"
					/>
					<nz-alert
						*ngIf="nameAlreadyExisting"
						nzType="error"
						[nzMessage]="'NameAlreadyExisting' | translate"
					></nz-alert>
				</div>

				<div class="full-padding">
					<span class="inline-block">{{ 'Year' | translate }} :</span>
					<nz-year-picker
						nzAllowClear="false"
						[(ngModel)]="newCalendarYear"
						(ngModelChange)="newYearTab($event)"
						[nzPlaceHolder]="'AddYear' | translate"
					></nz-year-picker>
				</div>
			</div>
		</div>

		<nz-tabset [nzSelectedIndex]="newCalendarTabIndex" *ngIf="newCalendarYears.length > 0" nzAnimated="false">
			<nz-tab *ngFor="let year of newCalendarYears" [nzTitle]="year.Year">
				<nz-layout>
					<nz-header>
						<div class="con-row">
							<button nz-tooltip nz-button nzType="danger" (click)="deleteYearTab(year)">
								{{ 'DeleteThisYear' | translate }}
							</button>
						</div>
					</nz-header>
					<nz-layout>
						<nz-sider nzWidth="300">
							<nz-date-picker
								nzOpen="true"
								nzShowToday="true"
								nzAllowClear="false"
								[nzDisabledDate]="disabledDate"
								[(ngModel)]="newDateForYear"
								(ngModelChange)="addNewDateForYear($event, year)"
							></nz-date-picker>
						</nz-sider>
						<nz-content>
							<nz-list [nzDataSource]="year.Dates" [nzRenderItem]="date">
								<ng-template #date let-date>
									<nz-list-item class="bank-holiday-calendar-list-date">
										<span class="inline-block">
											{{ 'Date' | translate }} :

											<nz-date-picker nzShowToday="true" [(ngModel)]="date.Date"></nz-date-picker>
										</span>
										<span class="inline-block">
											{{ 'Description' | translate }} :

											<input
												nz-input
												[placeholder]="'Description' | translate"
												[(ngModel)]="date.Description"
											/>
										</span>
										<button
											nz-tooltip
											nz-button
											nzSize="small"
											nzType="danger"
											nzShape="circle"
											(click)="removeDateOfYear(year, date)"
										>
											<i nz-icon type="close" theme="outline"></i>
										</button>
									</nz-list-item>
								</ng-template>
							</nz-list>
						</nz-content>
					</nz-layout>
				</nz-layout>
			</nz-tab>
		</nz-tabset>

		<div class="con-row operation-buttons">
			<button nz-button nzType="default" (click)="cancelAddNewBankCalendar()">{{ 'Cancel' | translate }}</button>
			<button
				nz-button
				nzType="primary"
				[disabled]="newCalendarYears.length == 0 || nameAlreadyExisting || newCalendarName.length == 0"
				(click)="saveNewBankCalendar()"
			>
				{{ 'Save' | translate }}
			</button>
		</div>
	</div>

	<div *ngIf="isEdittingCalendar" class="editting-bank-holiday-calendar">
		<nz-collapse *ngIf="edittingCalendar">
			<nz-collapse-panel [nzHeader]="edittingCalendar.Name" nzActive="true">
				<div class="con-row">
					<div class="con-flex">
						<div>
							<span class="inline-block">{{ 'Name' | translate }} :</span>
							<input
								nz-input
								[placeholder]="'Name' | translate"
								[(ngModel)]="edittingCalendar.Name"
								(blur)="checkNewCalendarName()"
							/>
							<nz-alert
								*ngIf="nameAlreadyExisting"
								nzType="error"
								[nzMessage]="'NameAlreadyExisting' | translate"
							></nz-alert>
						</div>

						<div>
							<span class="inline-block">{{ 'Year' | translate }} :</span>
							<nz-year-picker
								nzAllowClear="false"
								[(ngModel)]="newCalendarYearOfEditting"
								(ngModelChange)="onChange($event)"
								[nzPlaceHolder]="'Year' | translate"
							></nz-year-picker>
							<button
								nz-button
								nz-tooltip
								nzType="default"
								nzShape="circle"
								[nzTitle]="'AddYear' | translate"
								(click)="addNewYearTabForExistingCalendar()"
							>
								<i nz-icon type="plus" theme="outline"></i>
							</button>
						</div>
					</div>
				</div>

				<nz-tabset [(nzSelectedIndex)]="edittingCalendar.SelectedTabIndex">
					<nz-tab [nzTitle]="year.Year" *ngFor="let year of edittingCalendar.Years">
						<div class="con-row">
							<button nz-tooltip nz-button nzType="danger" (click)="deleteYearTab(year)">
								{{ 'DeleteThisYear' | translate }}
							</button>
						</div>

						<nz-list [nzDataSource]="year.Dates" [nzRenderItem]="date">
							<ng-template #date let-date>
								<nz-list-item class="bank-holiday-calendar-list-date">
									<span class="inline-block">
										{{ 'Date' | translate }} :
										<nz-date-picker
											nzAllowClear="false"
											[(ngModel)]="date.Date"
											(ngModelChange)="onChange($event)"
										></nz-date-picker>
									</span>
									<span class="inline-block">
										{{ 'Description' | translate }} :

										<input
											nz-input
											[placeholder]="'Description' | translate"
											[(ngModel)]="date.Description"
										/>
									</span>
									<button
										nz-tooltip
										nz-button
										nzSize="small"
										nzType="danger"
										nzShape="circle"
										(click)="removeDateOfYear(year, date)"
									>
										<i nz-icon type="close" theme="outline"></i>
									</button>
								</nz-list-item>
							</ng-template>
						</nz-list>
					</nz-tab>
				</nz-tabset>

				<div class="con-row operation-buttons">
					<button nz-button nzType="danger" (click)="confirmDeleteHolidayCanlendar(edittingCalendar)">
						{{ 'Delete' | translate }}
					</button>
					<button nz-button nzType="primary" (click)="saveExistingHolidayCalendar(edittingCalendar)">
						{{ 'Save' | translate }}
					</button>
				</div>
			</nz-collapse-panel>
		</nz-collapse>
	</div>

	<div *ngIf="!isAddingNewCalendar && !isEdittingCalendar" class="bank-holiday-calendar-list">
		<nz-collapse *ngIf="bankHolidayCalendarsList.length > 0">
			<nz-collapse-panel
				*ngFor="let calendar of bankHolidayCalendarsList; index as calendarIndex"
				[nzHeader]="calendar.Name"
			>
				<nz-tabset [(nzSelectedIndex)]="calendar.SelectedTabIndex">
					<nz-tab [nzTitle]="year.Year" *ngFor="let year of calendar.Years">
						<nz-list [nzDataSource]="year.Dates" [nzRenderItem]="date">
							<ng-template #date let-date>
								<nz-list-item class="bank-holiday-calendar-list-date">
									<span class="inline-block">
										{{ 'Date' | translate }} : <span class="inline-block"> {{ date.Date }} </span>
									</span>
									<span class="inline-block">
										{{ 'Description' | translate }} :
										<span class="inline-block">{{ date.Description }} </span>
									</span>
								</nz-list-item>
							</ng-template>
						</nz-list>
					</nz-tab>
				</nz-tabset>

				<div class="con-row operation-buttons">
					<button nz-button nzType="danger" (click)="confirmDeleteHolidayCanlendar(calendar)">
						{{ 'Delete' | translate }}
					</button>
					<button nz-button nzType="primary" (click)="editHolidayCanlendar(calendar)">
						{{ 'Edit' | translate }}
					</button>
				</div>
			</nz-collapse-panel>
		</nz-collapse>
	</div>
</div>
