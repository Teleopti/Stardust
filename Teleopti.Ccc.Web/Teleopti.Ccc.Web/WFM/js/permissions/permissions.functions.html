<div class="row toolbar">
	<div class="col-md-8">
		<div class="input-prepend">
			<i class="mdi mdi-filter-outline"></i>
			<input type="text" name="filterDetails" ng-model="searchPermissions" placeholder="{{'PermissionsFilterThreeDots' | translate}}" />
		</div>
	</div>
	<div class="col-md-4">
		<div class="wfm-switch permissions-tree-switch">
			<input type="checkbox" id="switch1" ng-model="selectedFunctionsToggle" ng-click="node.show = true" />
			<label for="switch1">
				<span class="wfm-switch-label" translate>SelectedItems</span>
				<span class="wfm-switch-toggle"></span>
			</label>
		</div>

		<div class="wfm-switch permissions-tree-switch">
			<input type="checkbox" id="switch2" ng-model="unselectedFunctionsToggle" />
			<label for="switch2">
				<span class="wfm-switch-label" translate>NotSelectedItems</span>
				<span class="wfm-switch-toggle"></span>
			</label>
		</div>
	</div>
</div>

<div class="tree permissions-tree">
	<div ui-tree data-drag-enabled="false">
		<ol ui-tree-nodes="" ng-model="functionsDisplayed" id="tree-root" class="tree-line" toggle-focus>
			<li ng-repeat="node in functionsDisplayed | filter:searchPermissions | selectedFunctions:selectedFunctionsToggle | unselectedFunctions:unselectedFunctionsToggle" ui-tree-node ng-include="'nodes_renderer.html'"></li>
		</ol>
	</div>
</div>

<!-- Nested node template for functions -->
<script type="text/ng-template" id="nodes_renderer.html">
	<div class="tree-toggle-group">
		<div class="toggle-handle" ng-class="{open: node.show}" ng-click="node.show = !node.show"><i ng-show="childNodes().length > 0" class="mdi mdi-chevron-right"></i></div>
		<div ui-tree-handle class="ui-tree-handle" ng-class="{selected: node.selected}" ng-click="toggleFunctionForRole(this)">
			{{node.LocalizedFunctionDescription}} <!--{{nbSelected(childNodes()) }} / {{childNodes().length}} selected-->
			<span><i class="mdi mdi-check"></i></span>
		</div>
	</div>

	<ol ui-tree-nodes="" ng-model="node.ChildFunctions" ng-show="node.show">
		{{$node}}
		<li ng-repeat="node in node.ChildFunctions | filter:searchPermissions | selectedFunctions:selectedFunctionsToggle | unselectedFunctions:unselectedFunctionsToggle"
				ui-tree-node ng-include="'nodes_renderer.html'">
		</li>
	</ol>
</script>