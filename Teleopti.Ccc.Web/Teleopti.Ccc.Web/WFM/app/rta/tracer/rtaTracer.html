<section ui-view>

	<div class="view-header with-fab">
		<div class="view-title">
			<h1><i class="mdi mdi-alarm"></i> Rta Tracer
			</h1>
		</div>
	</div>

	<div class="con-row">
		<div class="con-flex">
			<div class="panel material-depth-1">
				<div class="con-row">
					<div class="con-flex">
						<label class="input-icon">
							<input style="margin-top: 10px;" ng-model="vm.userCode" type="text">
						</label>
					</div>
					<div class="con-flex">
						<button class="wfm-btn wfm-btn-invis-primary" ng-click="vm.trace()">Trace</button>
						<button class="wfm-btn wfm-btn-invis-primary" ng-click="vm.stop()">Stop</button>
						<button class="wfm-btn wfm-btn-invis-primary" ng-click="vm.clear()">Clear</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<h1>Tracers</h1>
	<div class="con-row">
		<div class="con-flex">
			<div class="panel material-depth-1">
				<table class="wfm-table">
					<tr ng-repeat="tracer in vm.tracers" class="process">
						<td width="200px">{{tracer.process}}</td>
						<td width="400px" ng-if="tracer.dataReceived">Received {{tracer.dataReceivedCount}} states by {{tracer.dataReceivedBy}} at {{tracer.dataReceivedAt}}</td>
						<td width="400px" ng-if="!tracer.dataReceived">Received nothing yet</td>
						<td width="200px">Checked at {{tracer.activityCheckAt}}</td>
						<td>Tracing {{tracer.tracing}}</td>
						<td width="400px">Last exception: {{tracer.exception}}</td>
					</tr>
				</table>
			</div>
		</div>
	</div>

	<div ng-repeat="tracedUser in vm.tracedUsers">
		<h1>{{tracedUser.user}}</h1>
		<div class="con-row">
			<div class="con-flex">
				<div class="panel material-depth-1">
					<table class="wfm-table">
						<tr ng-repeat="state in tracedUser.states" class="trace">
							<td width="200px" style="vertical-align: top">{{state.stateCode}}</td>
							<!-- track by $index cant be tested -->
							<td><span ng-repeat="trace in state.traces track by $index">{{trace}}<br/></span></td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>

</section>