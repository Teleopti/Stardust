<div class="view-header with-fab with-desc">
	<div class="view-title">
		<h1><i class="mdi mdi-account-convert"></i> {{'ScheduleAuditTrailReport'|translate}}</h1>
		<p>{{'AuditingPageName'|translate}}</p>
	</div>
	<div class="fab-wrapper">
		<button class="wfm-fab material-depth-1 grow-out" ng-show="vm.chartLoaded" ng-click="vm.chartLoaded = false"><i class="mdi mdi-magnify"></i>
			<md-tooltip>{{'Edit'|translate}}</md-tooltip>
		</button>
	</div>
</div>

<!-- <div class="con-row" ng-show="!showForm">
<div class="con-flex">
<div class="line-center">
<i class="mdi mdi-magnify huge-icon"></i>
<h2>{{'NarrowToSeeAll'|translate}}</h2>
<button type="button" class="wfm-btn wfm-btn-primary" ng-click="showForm = !showForm">{{'Search'|translate}}</button>
</div>
</div>
</div> -->

<div ng-cloak class="con-row" ng-show="!vm.chartLoaded">
	<div class="con-flex">
		<div class="panel material-depth-1">
			<md-progress-linear ng-if="vm.loading" md-mode="indeterminate"></md-progress-linear>
			<form name="form" class="wfm-form" novalidate ng-submit="vm.sendForm(form)">
				<div class="con-row">
					<div class="con-flex">
						<div class="form-input-wrap">
							<label>{{'ScheduleDateColon'|translate}}</label><br/>
							<div class="inline-flex baseline pointer" ng-click="toggleSchedule =!toggleSchedule">
								<div tabindex=0 class="context-menu card-context">
									<i class="mdi mdi-calendar"></i>
								</div>
								<div ng-if="vm.dateModifyRange.startDate">{{'From'| translate}}: {{vm.dateModifyRange.startDate | amDateFormat:"L"}}</div>
								&nbsp;
								&nbsp;
								&nbsp;
								<div ng-if="vm.dateModifyRange.endDate">{{'To'|translate}}: {{vm.dateModifyRange.endDate | amDateFormat:"L"}}</div>
								<div ng-if="!vm.dateModifyRange.endDate && !vm.dateModifyRange.startDate" class="text-warning"> No selected date</div>
							</div>

							<wfm-popup show="toggleSchedule" class="datepicker-popup">
							    <wfm-calendar-picker ng-model="vm.dateModifyRange" ng-change="vm.getOrgData()"></wfm-calendar-picker>
							</wfm-popup>
						</div>

						<div class="form-input-wrap">
							<label>{{'ChangeDateColon'|translate}}</label></br>
							<div class="inline-flex baseline pointer" ng-click="toggleChange =!toggleChange">
								<div tabindex=0 class="context-menu card-context">
									<i class="mdi mdi-calendar"></i>
								</div>
								<div ng-if="vm.dateChangeRange.startDate">{{'From'| translate}}: {{vm.dateChangeRange.startDate | amDateFormat:"L"}}</div>
								&nbsp;
								&nbsp;
								&nbsp;
								<div ng-if="vm.dateChangeRange.endDate">{{'To'|translate}}: {{vm.dateChangeRange.endDate | amDateFormat:"L"}}</div>
								<div ng-if="!vm.dateChangeRange.endDate && !vm.dateChangeRange.startDate" class="text-warning"> No selected date</div>
							</div>

							<wfm-popup show="toggleChange" class="datepicker-popup">
							    <wfm-calendar-picker ng-model="vm.dateChangeRange"></wfm-calendar-picker>
							</wfm-popup>
						</div>
						<div class="form-input-wrap" ng-class="{'non-pointer': vm.orgData.Children.length<1}">
							<label>{{'OrganizationHierarchy'|translate}}:</label></br>
							<div tabindex=0 class="context-menu card-context" ng-click="showOrgPicker =!showOrgPicker">
								<i class="mdi mdi-file-tree"></i>
								<md-tooltip>{{'BusinessHierarchy'|translate}}</md-tooltip>
							</div>
							<span ng-click="showOrgPicker =!showOrgPicker" ng-class="{'text-warning': vm.filteredOrgData.length<1 }" ng-hide="vm.orgData.Children.length<1">{{vm.label}}</span>
							<span class="text-danger" ng-show="vm.orgData.Children.length<1">{{'NoTeamsAvailable'|translate}}</span>
							<wfm-popup show="showOrgPicker">
								<div class="con-row">
									<div class="con-flex">
										<tree-data-two ng-model="vm.orgData" option="vm.option" ng-click="vm.calculateOrgSelection(vm.orgData.Children)"></tree-data-two>
									</div>
								</div>
							</wfm-popup>
						</div>
					</div>
					<div class="con-flex">
						<div class="form-input-wrap">
							<label for="drop">{{'ChangedBy'|translate}}:</label>
							<md-select ng-model="form.drop" id="drop" aria-label="changed by">
								<md-option ng-repeat="item in vm.changedBy | orderBy:'Name'" ng-value="item" ng-selected="item.Default">
									{{item.Name}}
								</md-option>
							</md-select>
						</div>
						<!-- <div class="form-input-wrap">
						<label>{{'Limit'|translate}}:</label>
						<input type="number" id="max" name="max" min="1" max="1000" ng-model="vm.maxResults" required>
					</div> -->
				</div>
				<div class="con-flex"></div>
			</div>
			<div class="con-footer">
				<button class="wfm-btn wfm-btn-invis-primary" type="submit">
					<md-tooltip>{{'Search'|translate}}</md-tooltip>
					{{'SubmitRequest'|translate}}
				</button>
			</div>
		</form>
	</div>
</div>
</div>

<div class="con-row" ng-if="vm.chartLoaded">
	<div class="con-flex">
		<div class="panel material-depth-1">
			<div class="con-row full-padding">
				<div class="con-flex">
					<label for="filter" class="input-icon">
						<i class="mdi mdi-magnify">
							<input type="text" id="filter" ng-model="searchText" ng-change="vm.refreshData(searchText)" autofocus="true" placeholder="{{'Filter'|translate}}">
							<md-tooltip>{{'Filter'|translate}}</md-tooltip>
						</i>
					</label>
				</div>
				<div class="con-flex x3 line-right">
					{{'TotalColon'| translate}}{{vm.changesData.length}}
				</div>
			</div>
			<div class="con-row">
				<div class="con-flex ">
					<div class="big-table-wrapper" style="max-width:100%;"> <!-- ui-i18n="{{vm.gridLang}}" -->
						<div ui-grid="vm.gridOptions" ui-grid-exporter ui-grid-auto-resize ui-grid-selection ui-grid-disable-animation style="height: 70vh;" class="myGrid"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
