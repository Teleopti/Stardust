<div class="con-row progress-linear-container">
	<md-progress-linear ng-if="vm.isSaving || vm.isLoading" md-mode="indeterminate"></md-progress-linear>
</div>
<div class="activity-info">
	<div class="pull-left" ng-if="!!vm.selectedShiftLayers.length">
		<span class="timespan">{{ vm.getSelectionTimeSpan()  }}</span>
		<span>
			<md-select class="activity-selector" ng-model="vm.selectedActivitiyId" ng-change="vm.changeActivityType()" required placeholder="{{'SelectAnActivity'|translate}}">
				<md-option ng-repeat="activity in vm.availableActivities" ng-value="activity.Id">
					<span class="type-color" ng-style="{'background-color': activity.Color}"></span>
					<span class="type-name"> {{activity.Name}}</span>
				</md-option>
			</md-select>
		</span>
	</div>

	<button type="button" class="context-menu card-context btn-refresh pull-right" disabled ng-disabled="!vm.isChangedByOthers" ng-click="vm.refreshData()">
		<i class="mdi mdi-refresh"></i>
		<md-tooltip>
			{{'Refresh' | translate}}
		</md-tooltip>
	</button>

</div>

<div class="shift-container" ng-class="{'tablet': !vm.isOnDesktop}">
	<div class="viewport-clip height-4em">
		<div class="viewport">
			<div class="timeline" tabindex="0" ng-style="{'width':vm.timelineVmWidth+'px'}">
				<div class="scroll-toolbar">
					<span class="left-scroll" ng-show="vm.showScrollLeftButton" ng-click="vm.scroll(-60)"><i class="mdi mdi-chevron-left"></i></span>
					<span class="right-scroll" ng-show="vm.showScrollRightButton" ng-click="vm.scroll(60)"><i class="mdi mdi-chevron-right"></i></span>
				</div>
				<div ng-repeat="interval in vm.timelineVm.Intervals" class="interval">
					<div class="time-label">
						<span class="label label-info" ng-class="{'highlight': vm.isSameDate(interval)}">{{ interval.Label}}</span>
					</div>
					<div class="ticks">
						<span ng-repeat="tick in interval.Ticks" class="tick" ng-class="{'half-hour': tick.IsHalfHour, 'hour':tick.IsHour}"></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="viewport-clip height-7em">
		<div class="viewport  no-scroll">
			<div class="shift"
				 ng-style="{'width':vm.timelineVmWidth+'px'}"
				 ng-class="{'has-selected': !!vm.selectedShiftLayers.length}">
				<div class="shift-layer"
					 ng-class="{
					 'overtime-light':shiftLayer.IsOvertime && vm.useLighterBorder(shiftLayer),
					 'overtime-dark':shiftLayer.IsOvertime && !vm.useLighterBorder(shiftLayer),
					 'selected': vm.isSelected(shiftLayer),
					 'border-dark': !vm.useLighterBorder(shiftLayer),
					 'border-light': vm.useLighterBorder(shiftLayer),
					 'divide-line':  shiftLayer.ShowDividedLine,
					 'disabled': vm.isNotAllowedToChange(shiftLayer),
					 'non-resizable': vm.isNotResizable(shiftLayer),
					 'float-top': vm.getMergedShiftLayer(shiftLayer).FloatOnTop}"
					 ng-attr-index="{{vm.scheduleVm.ShiftLayers.indexOf(shiftLayer)}}"
					 ng-style="{'width': vm.getMergedShiftLayer(shiftLayer).Width +'px',
					 'background-color': vm.getMergedShiftLayer(shiftLayer).Color,
					 'left': vm.getMergedShiftLayer(shiftLayer).Left + 'px',
					 'transform': 'translate('+ (vm.getMergedShiftLayer(shiftLayer).TranslateX || 0)+'px, 0px)'}"
					 ng-click="vm.toggleSelection(shiftLayer, $event)"
					 ng-repeat="shiftLayer in vm.scheduleVm.ShiftLayers">
				</div>
			</div>
		</div>
	</div>
</div>
<div class="con-footer">
	<div class="con-row">
		<div class="con-flex text-right">
			<div class="text-danger error-info" ng-if="vm.showError">
				<i class="mdi mdi-alert-octagon"></i>
				<span>{{'scheduleChangedByOthers' | translate}}</span>
			</div>
			<button type="button" class="wfm-btn wfm-btn-invis-default btn-cancel" ng-click="vm.cancelEditing()">{{ 'Cancel'|translate }}</button>
			<button type="button" class="wfm-btn wfm-btn-invis-default btn-save" ng-click="vm.saveChanges()" ng-disabled="vm.isSaveButtonDisabled()">{{ 'Save'|translate }}</button>
		</div>
	</div>
</div>
