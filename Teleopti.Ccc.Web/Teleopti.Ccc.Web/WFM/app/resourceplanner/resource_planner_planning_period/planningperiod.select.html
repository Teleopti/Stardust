<div class="view-header with-fab with-desc">
	<div class="view-title">
		<h1><i class="mdi mdi-calendar"></i> {{'ScheduleAgentGroup' | translate}} - {{vm.agentGroup.Name}}</h1>
		<div class="pp-sub-title">
			<span ng-hide="vm.selectedPp">{{'SelectPpWorkWith' | translate}} </span>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex">
		<button ng-if="!vm.isNonePp() && vm.displayButton" class="wfm-btn wfm-btn-default" ng-click="vm.startNextPlanningPeriod()">{{'CreateNextPp' | translate}}</button>
		<button ng-if="vm.isNonePp() && vm.displayButton" class="wfm-btn wfm-btn-default" ng-click="vm.getSuggestionsForFirstPp()">{{'CreateFirstPlanningPeriod' | translate}}</button>
		<div class="line-right pp-color-label" ng-if="!vm.isNonePp() && vm.displayButton">
			<span><i class="mdi mdi-checkbox-blank-circle pp-scheduled-label"></i>{{'SchedulingSucceeded' | translate}}</span>
			<span><i class="mdi mdi-checkbox-blank-circle pp-scheduled-failed-label"></i>{{'SchedulingFailed' | translate}}</span>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex">
		<div class="wfm-grid">
			<div class="grid-card" ng-repeat="p in vm.planningPeriods | orderBy: '-EndDate'">
				<div class="list-content panel" ng-class="{'pp-scheduled':p.State == 'Scheduled', 'pp-scheduled-failed':p.State == 'ScheduleFailed'|| p.State == 'IntradayOptimizationFailed'}"
				 ng-click="vm.selectPp(p)">
					<div class="ag-pp">
						<div class="con-flex x3 pp-inner-card">
							<span>
								<i title="Scheduled" ng-if="p.State == 'Scheduled'" class="mdi mdi-calendar-check"></i>
								<i title="Scheduled" ng-if="p.State !== 'Scheduled'" class="mdi mdi-calendar-remove"></i>
								{{p.StartDate | amDateFormat:"L"}}-{{p.EndDate | amDateFormat:"L"}}
							</span>
						</div>
						<div class="con-flex head-actions panel-menu" ng-click="$event.stopPropagation();" ng-show="$first">
							<div tabindex=0 class="context-menu card-context">
								<i class="mdi mdi-dots-vertical"></i>
								<div class="context-menu-left">
									<ul class="wfm-list">
										<li ng-click="vm.getLastPp(p);"><i class="mdi mdi-pencil"></i>{{'ChangePlanningDuration' | translate}}</li>
										<li ng-hide="vm.planningPeriods.length == 1" ng-click="vm.getPpInfo(p)"><i class="mdi mdi-close"></i>{{'DeletePlanningPeriod' | translate}}</li>
									</ul>
								</div>
							</div>
							<div ng-cloak class="modal-box">
								<div ng-cloak ng-show="vm.confirmDeletePpModal">
									<div class="modalbg">
										<div class="dialog-mini material-depth-1">
											<div class="modal-inner-content">
												<h3>{{'DeletePlanningPeriod' | translate}}</h3>
												{{vm.textForDeletePp}}
											</div>
											<div class="modal-actions">
												<aside>
													<button ng-click="vm.confirmDeletePpModal=false" class="wfm-btn wfm-btn-invis-default" translate>Cancel</button>
													<button ng-click="vm.deleteLastPp(vm.agentGroup.Id);" class="wfm-btn wfm-btn-invis-primary" translate>Delete</button>
												</aside>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="con-row" ng-if="vm.isNonePp() && vm.displayButton">
	<div class="con-flex">
		<div class="panel wfm-tip">
			<div class="sub-header wfm-tip-header">
				<h2><i class="mdi mdi-information-outline"></i>{{'YouNeedAPlanningPeriodToScheduleYourAgentsDoYouWantToCreateAPlanningPeriodQuestion' | translate}}</h2>
			</div>
			<div class="con-footer">
				<button class="wfm-btn wfm-btn-invis-primary" ng-click="vm.getSuggestionsForFirstPp()" translate>CreatePlanningPeriod</button>
			</div>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex pp-modal">
		<div ng-cloak class="modal-box">
			<div ng-cloak ng-show="vm.modifyLastPpModal">
				<div class="modalbg">
					<div class="dialog material-depth-1">
						<div class="modal-inner-content">
							<h3>{{'ChangePlanningPeriodDurationColon' | translate}} {{vm.originLastPp.startDate | amDateFormat:"L"}} - {{vm.originLastPp.endDate | amDateFormat:"L"}}</h3>
							<div class="con-row">
								<label ng-if="!vm.dateIsChanged && vm.planningPeriods.length > 1">
									<i class="mdi mdi-information-outline"></i> {{'ModifyEndDateForThisPlanningPeriodDot' | translate}}</label>
								<label ng-if="!vm.dateIsChanged && vm.planningPeriods.length == 1"><i class="mdi mdi-information-outline"></i> {{'ModifyStartAndEndDateForThisPlanningPeriodDot' | translate}}</label>
								<label ng-if="vm.dateIsChanged" class="text-warning">
								    <i class="mdi mdi-alert"></i>
									{{vm.textForChangeThisPpMeg}}
								</label>
							</div>
							<div class="con-row">
								<date-range-picker class="pp-datepicker" ng-model="vm.lastPp" ng-change="vm.isDateChanged()"></date-range-picker>
							</div>
						</div>
						<div class="modal-actions">
							<aside>
								<button ng-click="vm.modifyLastPpModal=false" class="wfm-btn wfm-btn-invis-default" translate>
									Cancel
								</button>
								<button ng-class="{'wfm-btn-invis-primary':vm.dateIsChanged, 'wfm-btn-invis-disabled': !vm.dateIsChanged}" ng-click="vm.changeDateForLastPp(vm.lastPp);" class="wfm-btn" translate>
									Apply
								</button>
							</aside>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex pp-modal">
		<div ng-cloak class="modal-box">
			<div ng-cloak ng-show="vm.openCreatePpModal && vm.show == true">
				<div class="modalbg">
					<div class="dialog material-depth-1">
						<div class="modal-inner-content">
							<h3>{{'CreateFirstPlanningPeriod' | translate}}</h3>
							<div class="con-row">
								<div class="con-flex">
									<div class="wfm-chip-wrap" ng-repeat="s in vm.suggestions | limitTo: 10">
										<span class="wfm-chip" ng-click="vm.selectSuggestion(s)">
										<span class="chip-handle">{{s.Number}}{{s.PeriodType}}</span>
										<span class="chip-text">{{s.StartDate | amDateFormat:"L"}} - {{s.EndDate | amDateFormat:"L"}}</span>
										</span>
									</div>
								</div>
							</div>
							<div class="con-row" >
								<label ng-show="!vm.selectedIsChanged"><i class="mdi mdi-information-outline"></i>{{'SelectASuggestedPeriodToWorkWithOrPickStartAndEndDateDirectlyDot' | translate}}</label>
							    <label ng-show="vm.selectedIsChanged" class="text-warning"><i class="mdi mdi-alert"></i>{{vm.textForCreatePpMeg}}</label>
							</div>
							<div class="con-row">
								<date-range-picker class="pp-datepicker" ng-model="vm.selectedSuggestion" ng-change="vm.isSelectedChanged()"></date-range-picker>
							</div>
						</div>
						<div class="modal-actions">
							<aside>
								<button ng-click="vm.resetSelectedSuggestion()" class="wfm-btn wfm-btn-invis-default" translate>
									Cancel
								</button>
								<button ng-class="{'wfm-btn-invis-primary':vm.selectedIsChanged, 'wfm-btn-invis-disabled': !vm.selectedIsChanged}" ng-click="vm.createFirstPp()" class="wfm-btn" translate>
									Apply
								</button>
							</aside>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
