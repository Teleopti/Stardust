<div class="view-header with-fab with-desc">
	<div class="view-title">
		<h1><i class="mdi mdi-calendar"></i> Schedule Agent Group "{{vm.agentGroup.Name}}"</h1>
		<div class="pp-sub-title">
			<span ng-hide="vm.selectedPp">Select planning period to work with</span>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex">
		<button ng-if="vm.planningPeriods !== undefined && vm.planningPeriods.length > 0" class="wfm-btn wfm-btn-default" ng-click="vm.startNextPlanningPeriod()">Create next planning period</button>
		<button ng-if="vm.planningPeriods !== undefined && vm.planningPeriods.length == 0" class="wfm-btn wfm-btn-default" ng-click="vm.modifyFirstPpModal = true; vm.getSugesstionsForFirstPp()">Create planning period</button>
		<div class="wfm-grid">
			<div class="grid-card" ng-repeat="p in vm.planningPeriods | orderBy: '-EndDate'">
				<div class="list-content panel" ng-class="{'pp-scheduled':p.State == 'Scheduled'}">
					<div class="ag-pp">
						<div class="con-flex x3 pp-inner-card" ng-click="vm.selectPp(p)">
							<span>
								<i title="Scheduled" ng-if="p.State == 'Scheduled'" class="mdi mdi-calendar-check"></i>
								<i title="Scheduled" ng-if="p.State !== 'Scheduled'" class="mdi mdi-calendar-remove"></i>
								{{p.StartDate | amDateFormat:"L"}}-{{p.EndDate | amDateFormat:"L"}}
							</span>
						</div>
						<div class="con-flex head-actions panel-menu" ng-show="$first">
							<div tabindex=0 class="context-menu card-context">
								<i class="mdi mdi-dots-vertical"></i>
								<div class="context-menu-left">
									<ul class="wfm-list">
										<li ng-click="vm.getLastPp(p); vm.modifyLastPpModal=true; "><i class="mdi mdi-pencil"></i>Edit planning period</li>
										<li ng-hide="vm.planningPeriods.length == 1" ng-click="vm.deleteLastPp(vm.agentGroup.Id)"><i class="mdi mdi-close"></i>Delete planning period</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="con-row" ng-if="vm.planningPeriods !== undefined && vm.planningPeriods.length == 0">
	<div class="con-flex">
		<div class="panel wfm-tip">
			<div class="sub-header wfm-tip-header">
				<h2><i class="mdi mdi-information-outline"></i> You need an planning period to schdule your agents. Do you want to create planning period?</h2>
			</div>
			<div class="con-footer">
				<button class="wfm-btn wfm-btn-invis-primary" ng-click="vm.modifyFirstPpModal = true; vm.getSugesstionsForFirstPp()">Create planning period</button>
			</div>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex pp-modal">
		<div ng-cloak class="modal-box">
			<div ng-cloak ng-show="vm.modifyLastPpModal">
				<div class="modalbg">
					<div class="dialog material-depth-1">
						<div class="modal-inner-content">
							<h3>Edit Planning Period: {{vm.originLastPp.StartDate | amDateFormat:"L"}} - {{vm.originLastPp.EndDate | amDateFormat:"L"}}</h3>
							<div class="con-row">
								<label ng-if="!vm.isEnddateChanged()"><i class="mdi mdi-information-outline"></i> Select a new end date for this planning period.</label>
								<label ng-if="vm.isEnddateChanged()" class="text-warning">
									<i class="mdi mdi-alert"></i> You are going to change the end date of this planning period from {{vm.originLastPp.EndDate | amDateFormat:"L"}} to {{vm.lastPp.endDate | amDateFormat:"L"}}
								</label>
							</div>
							<div class="con-row">
								<date-range-picker class="pp-datepicker" ng-model="vm.lastPp"></date-range-picker>
							</div>
						</div>
						<div class="modal-actions">
							<aside>
								<button ng-click="vm.modifyLastPpModal=false" class="wfm-btn wfm-btn-invis-default">Cancel</button>
								<button ng-class="{'wfm-btn-invis-primary':vm.isEnddateChanged(), 'wfm-btn-invis-disabled': !vm.isEnddateChanged()}" ng-click="vm.modifyLastPpModal=false; vm.changeEndDateForLastPp(vm.lastPp);"
								 class="wfm-btn ">Apply</button>
							</aside>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="con-row">
	<div class="con-flex pp-modal">
		<div ng-cloak class="modal-box">
			<div ng-cloak ng-show="vm.modifyFirstPpModal">
				<div class="modalbg">
					<div class="dialog material-depth-1">
						<div class="modal-inner-content">
							<h3>Create First Planning Period</h3>
							<div class="con-row">
								<div class="con-flex">
									<p><i class="mdi mdi-information-outline"></i>Select a suggest plan to work with or pick start date and end date directly.</p>
									<div class="wfm-chip-wrap" ng-repeat="s in vm.suggestions">
										<span class="wfm-chip" ng-click="vm.selectSuggestion(s)">
										<span class="chip-handle">{{s.Number}}{{s.PeriodType}}</span>
										<span class="chip-text">{{s.StartDate | amDateFormat:"L"}} - {{s.EndDate | amDateFormat:"L"}}</span>
										</span>
									</div>
								</div>
							</div>
							<div class="con-row" ng-show="vm.selectedSuggestion.endDate">
								<label class="text-warning">
									<i class="mdi mdi-alert"></i> You are going to create this planning period from {{vm.selectedSuggestion.startDate | amDateFormat:"L"}} to {{vm.selectedSuggestion.endDate | amDateFormat:"L"}}
								</label>
							</div>
							<div class="con-row">
								<date-range-picker class="pp-datepicker" ng-model="vm.selectedSuggestion"></date-range-picker>
							</div>
						</div>
						<div class="modal-actions">
							<aside>
								<button ng-click="vm.modifyFirstPpModal=false; vm.resetSelectedSuggestion()" class="wfm-btn wfm-btn-invis-default">Cancel</button>
								<button ng-class="{'wfm-btn-invis-primary':vm.selectedSuggestion, 'wfm-btn-invis-disabled': !vm.selectedSuggestion}"ng-click="vm.modifyFirstPpModal=false; vm.createFirstPp()"
								 class="wfm-btn ">Apply</button>
							</aside>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>