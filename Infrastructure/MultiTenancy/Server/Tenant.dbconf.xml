<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
						assembly="Teleopti.Ccc.Infrastructure"
						namespace="Teleopti.Ccc.Infrastructure.MultiTenancy.Server"
						default-access="property"
						schema="Tenant">
	<class name="Tenant">
		<id name="Id">
			<generator class="identity" />
		</id>
		<property name="Name" />
		<property name="RtaKey" />
		<component name="DataSourceConfiguration">
			<property name="ApplicationConnectionString" />
			<property name="AnalyticsConnectionString" />
			<property name="AggregationConnectionString" />
			<map name="ApplicationConfig" table="TenantApplicationConfig" access="field.camelcase-underscore">
				<key column="TenantId"/>
				<index column="ConfigKey" type="string"/>
				<element column="ConfigValue" />
			</map>
		</component>
    <property name="Active" />
	</class>

	<query name="loadAllTenants">
		<![CDATA[
select t from Tenant t
]]>
	</query>
	<query name="findByName">
		select t from Tenant t
		join fetch t.DataSourceConfiguration.ApplicationConfig
		where t.Name=:name
	</query>
	
</hibernate-mapping>